{
  "metadata": {
    "timestamp": "2025-12-16T01:40:14.329080",
    "repository": "/etc/nixos",
    "model": "qwen2.5-coder:7b-instruct",
    "duration_seconds": 1529.705168051998
  },
  "summary": {
    "total_modules": 226,
    "total_lines": 34953,
    "categories": {
      "TEMPLATE.nix": 1,
      "development": 5,
      "tools": 9,
      "shell": 35,
      "hardware": 12,
      "network": 12,
      "containers": 4,
      "debug": 4,
      "applications": 8,
      "services": 16,
      "system": 10,
      "desktop": 4,
      "ml": 22,
      "security": 17,
      "virtualization": 4,
      "_sources": 1,
      "packages": 36,
      "soc": 14,
      "programs": 4,
      "audio": 3,
      "secrets": 5
    },
    "security_score": 100,
    "patterns": [
      "monolithic architecture",
      "category-based organization"
    ],
    "technical_debt": [
      "Some modules are quite complex, which could indicate technical debt",
      "Less common categories like debug and virtualization might not be frequently maintained"
    ]
  },
  "modules": [
    {
      "path": "modules/TEMPLATE.nix",
      "name": "TEMPLATE",
      "category": "TEMPLATE.nix",
      "purpose": "This module provides a template for creating NixOS modules with configurable options and basic system integration.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "enable",
        "enableFeature",
        "extraConfig",
        "package"
      ],
      "security_concerns": [],
      "recommendations": [
        "Replace 'category.module-name' with the actual path (e.g., programs.myapp or services.myservice).",
        "Define a submodule if nested configuration is needed.",
        "Add examples for service definitions and configuration files to demonstrate how to use the module."
      ],
      "lines_of_code": 106,
      "has_documentation": true,
      "analysis_time_ms": 7950,
      "error": null
    },
    {
      "path": "modules/development/default.nix",
      "name": "default",
      "category": "development",
      "purpose": "Aggregates various development-related NixOS modules",
      "complexity": "low",
      "dependencies": [
        "./cicd.nix",
        "./claude-profiles.nix",
        "./environments.nix",
        "./jupyter.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 10,
      "has_documentation": true,
      "analysis_time_ms": 47571,
      "error": null
    },
    {
      "path": "modules/development/claude-profiles.nix",
      "name": "claude-profiles",
      "category": "development",
      "purpose": "Provides a shell script for managing API profiles for Claude Code, including listing, setting, and using different profiles.",
      "complexity": "low",
      "dependencies": [
        "pkgs.writeShellScriptBin"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.development.claudeProfiles.enable"
      ],
      "security_concerns": [
        "The script writes sensitive environment variables to a file without encryption or obfuscation, which could be a security risk if the file is not properly secured."
      ],
      "recommendations": [
        "Consider encrypting or obfuscating sensitive environment variables before writing them to disk."
      ],
      "lines_of_code": 428,
      "has_documentation": true,
      "analysis_time_ms": 15172,
      "error": null
    },
    {
      "path": "modules/development/cicd.nix",
      "name": "cicd",
      "category": "development",
      "purpose": "Enables CI/CD development tools and pre-commit hooks in NixOS",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.development.cicd.enable",
        "kernelcore.development.cicd.platforms.github",
        "kernelcore.development.cicd.platforms.gitlab",
        "kernelcore.development.cicd.platforms.gitea",
        "kernelcore.development.cicd.docker",
        "kernelcore.development.cicd.pre-commit.enable",
        "kernelcore.development.cicd.pre-commit.checkDirty",
        "kernelcore.development.cicd.pre-commit.runTests",
        "kernelcore.development.cicd.pre-commit.formatCode",
        "kernelcore.development.cicd.pre-commit.flakeCheckOnPush",
        "kernelcore.development.cicd.pre-commit.autoCommit"
      ],
      "security_concerns": [
        "Potential for uncommitted changes to be pushed without proper checks if auto-commit is enabled and fails"
      ],
      "recommendations": [
        "Consider adding more detailed logging in pre-commit hooks for better visibility during development"
      ],
      "lines_of_code": 313,
      "has_documentation": true,
      "analysis_time_ms": 44120,
      "error": null
    },
    {
      "path": "modules/development/jupyter.nix",
      "name": "jupyter",
      "category": "development",
      "purpose": "This module configures a Jupyter notebook environment with various kernels and extensions.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.development.jupyter.enable",
        "kernelcore.development.jupyter.kernels.python.enable",
        "kernelcore.development.jupyter.kernels.rust.enable",
        "kernelcore.development.jupyter.kernels.nodejs.enable",
        "kernelcore.development.jupyter.kernels.nix.enable",
        "kernelcore.development.jupyter.service.enable",
        "kernelcore.development.jupyter.extensions.enable"
      ],
      "security_concerns": [
        "DeviceAllow and SupplementaryGroups for GPU access could pose security risks if not properly managed.",
        "NoNewPrivileges is set, which is good practice for hardening the service."
      ],
      "recommendations": [
        "Consider adding more detailed documentation on how to securely configure GPU access.",
        "Review and potentially remove commented-out packages that may not be necessary."
      ],
      "lines_of_code": 148,
      "has_documentation": true,
      "analysis_time_ms": 56824,
      "error": null
    },
    {
      "path": "modules/development/environments.nix",
      "name": "environments",
      "category": "development",
      "purpose": "This module configures development environments for Rust, Go, Python, Node.js, and Nix tools in a NixOS system.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.development.rust.enable",
        "kernelcore.development.go.enable",
        "kernelcore.development.python.enable",
        "kernelcore.development.nodejs.enable",
        "kernelcore.development.nix.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 74,
      "has_documentation": false,
      "analysis_time_ms": 27309,
      "error": null
    },
    {
      "path": "modules/tools/dev.nix",
      "name": "dev",
      "category": "tools",
      "purpose": "Provides a set of development tools including AI-powered commit messages, project pushes, and git hooks setup.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.dev.enable"
      ],
      "security_concerns": [
        "The script uses `exec` which can execute arbitrary commands if not properly sanitized. There is no input validation for the command arguments."
      ],
      "recommendations": [
        "Add input validation and sanitization to the scripts to prevent command injection attacks."
      ],
      "lines_of_code": 111,
      "has_documentation": true,
      "analysis_time_ms": 32424,
      "error": null
    },
    {
      "path": "modules/tools/secops.nix",
      "name": "secops",
      "category": "tools",
      "purpose": "Provides a command-line interface for various security operations such as monitoring, scanning, and generating reports.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.secops.enable"
      ],
      "security_concerns": [
        "The script relies on external scripts located in `/etc/nixos/scripts` which may not be secure or up-to-date.",
        "The `report` command runs `sudo lynis audit system`, which could pose a security risk if the user running the script does not have sufficient privileges."
      ],
      "recommendations": [
        "Ensure that all external scripts used by SecOps are reviewed for security vulnerabilities and are kept up-to-date.",
        "Consider implementing more granular permissions for the `report` command to reduce potential risks."
      ],
      "lines_of_code": 105,
      "has_documentation": true,
      "analysis_time_ms": 22477,
      "error": null
    },
    {
      "path": "modules/tools/llm.nix",
      "name": "llm",
      "category": "tools",
      "purpose": "Provides a command-line interface for interacting with a local Large Language Model (LLM) server.",
      "complexity": "low",
      "dependencies": [
        "pkgs.jq",
        "pkgs.curl"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.llm.enable"
      ],
      "security_concerns": [
        "The script uses environment variables and external scripts which could be insecure if not properly managed."
      ],
      "recommendations": [
        "Consider adding input validation for the prompt to prevent injection attacks.",
        "Ensure that the LLM server URL is secure and not hardcoded in the script."
      ],
      "lines_of_code": 115,
      "has_documentation": true,
      "analysis_time_ms": 62858,
      "error": null
    },
    {
      "path": "modules/tools/default.nix",
      "name": "default",
      "category": "tools",
      "purpose": "Aggregates and configures various tools for NixOS systems, including a unified CLI launcher.",
      "complexity": "medium",
      "dependencies": [
        "./intel.nix",
        "./secops.nix",
        "./nix-utils.nix",
        "./dev.nix",
        "./secrets.nix",
        "./diagnostics.nix",
        "./llm.nix",
        "./mcp.nix"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 157,
      "has_documentation": true,
      "analysis_time_ms": 69681,
      "error": null
    },
    {
      "path": "modules/tools/secrets.nix",
      "name": "secrets",
      "category": "tools",
      "purpose": "Provides a command-line tool for managing secrets using SOPS and other utilities.",
      "complexity": "low",
      "dependencies": [
        "pkgs.sops",
        "secretsToolCmd"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.secrets.enable"
      ],
      "security_concerns": [
        "The script relies on external scripts located in /etc/nixos/scripts, which could be a security risk if not properly managed or trusted."
      ],
      "recommendations": [
        "Ensure that all external scripts referenced by the tool are securely stored and managed within the NixOS configuration to prevent unauthorized access or execution."
      ],
      "lines_of_code": 120,
      "has_documentation": true,
      "analysis_time_ms": 75820,
      "error": null
    },
    {
      "path": "modules/tools/diagnostics.nix",
      "name": "diagnostics",
      "category": "tools",
      "purpose": "Provides a command-line interface for various system diagnostics and troubleshooting tasks.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.diagnostics.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 86,
      "has_documentation": true,
      "analysis_time_ms": 79187,
      "error": null
    },
    {
      "path": "modules/tools/mcp.nix",
      "name": "mcp",
      "category": "tools",
      "purpose": "Provides a script for managing MCP server tools including health checks, configuration generation, and other utilities.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.mcp.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 103,
      "has_documentation": true,
      "analysis_time_ms": 82881,
      "error": null
    },
    {
      "path": "modules/tools/intel.nix",
      "name": "intel",
      "category": "tools",
      "purpose": "Provides a command-line tool for auditing and analyzing projects with various metrics.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.python3.withPackages",
        "pkgs.writeScriptBin",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.intel.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 190,
      "has_documentation": true,
      "analysis_time_ms": 88684,
      "error": null
    },
    {
      "path": "modules/tools/nix-utils.nix",
      "name": "nix-utils",
      "category": "tools",
      "purpose": "Provides a set of utility commands for managing and recovering NixOS systems.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.tools.nix-utils.enable"
      ],
      "security_concerns": [
        "The script uses `sudo` for some operations, which could pose security risks if not properly managed."
      ],
      "recommendations": [
        "Consider adding more detailed error handling and logging to improve reliability.",
        "Ensure that the scripts referenced in the utility commands are securely stored and maintained."
      ],
      "lines_of_code": 129,
      "has_documentation": true,
      "analysis_time_ms": 94525,
      "error": null
    },
    {
      "path": "modules/shell/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Manages shell configuration, including aliases, scripts, and environment settings for GPU monitoring, Docker, and Python automation.",
      "complexity": "medium",
      "dependencies": [
        "./gpu-flags.nix",
        "./aliases",
        "./training-logger.nix"
      ],
      "imports": [],
      "options_defined": [
        "shell.enableGpuMonitor",
        "shell.pythonScriptsPath"
      ],
      "security_concerns": [
        "The module exports sensitive environment variables (DOCKER_GPU_FLAGS, PYTORCH_IMAGE) which could be exposed if not properly secured."
      ],
      "recommendations": [
        "Consider adding more granular access controls for the exported environment variables.",
        "Review and sanitize any scripts that are installed system-wide to ensure they do not contain malicious code."
      ],
      "lines_of_code": 366,
      "has_documentation": true,
      "analysis_time_ms": 103457,
      "error": null
    },
    {
      "path": "modules/shell/gpu-flags.nix",
      "name": "gpu-flags",
      "category": "shell",
      "purpose": "Centralizes tested NVIDIA GPU flags for use in Docker containers within NixOS configurations.",
      "complexity": "low",
      "dependencies": [],
      "imports": [
        "torch",
        "torch"
      ],
      "options_defined": [
        "dockerFlags",
        "dockerFlagsList",
        "flags.device",
        "flags.ipc",
        "flags.ulimit",
        "flags.shmSize",
        "baseCommands.dockerRun",
        "baseCommands.dockerRunInteractive",
        "images.pytorch",
        "images.tgi",
        "images.tensorflow",
        "referenceAliases.tgi",
        "referenceAliases.pytorch",
        "referenceAliases.jupMl",
        "docs.flagsExplanation",
        "docs.commonIssues",
        "docs.testingProcedure"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 205,
      "has_documentation": true,
      "analysis_time_ms": 112185,
      "error": null
    },
    {
      "path": "modules/shell/training-logger.nix",
      "name": "training-logger",
      "category": "shell",
      "purpose": "Provides utilities for logging and managing long training sessions in the shell.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "shell.trainingLogger.enable",
        "shell.trainingLogger.logDirectory",
        "shell.trainingLogger.userLogDirectory",
        "shell.trainingLogger.autoTimestamp",
        "shell.trainingLogger.maxLogSize"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 647,
      "has_documentation": true,
      "analysis_time_ms": 118332,
      "error": null
    },
    {
      "path": "modules/hardware/bluetooth.nix",
      "name": "bluetooth",
      "category": "hardware",
      "purpose": "Enables Bluetooth support with GUI management on NixOS",
      "complexity": "low",
      "dependencies": [
        "kernelcore.bluetooth",
        "hardware.bluetooth",
        "services.blueman",
        "environment.systemPackages"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.bluetooth.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 47,
      "has_documentation": true,
      "analysis_time_ms": 121715,
      "error": null
    },
    {
      "path": "modules/hardware/default.nix",
      "name": "default",
      "category": "hardware",
      "purpose": "Imports all hardware-specific configurations for NixOS",
      "complexity": "low",
      "dependencies": [
        "./nvidia.nix",
        "./intel.nix",
        "./lenovo-throttled.nix",
        "./thermal-profiles.nix",
        "./trezor.nix",
        "./wifi-optimization.nix",
        "./bluetooth.nix",
        "./i915-governor"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 21,
      "has_documentation": true,
      "analysis_time_ms": 126592,
      "error": null
    },
    {
      "path": "modules/hardware/nvidia.nix",
      "name": "nvidia",
      "category": "hardware",
      "purpose": "Configures NVIDIA hardware and related services on NixOS",
      "complexity": "medium",
      "dependencies": [
        "hardware.nvidia",
        "virtualisation.vmVariant",
        "systemd.services",
        "users.groups"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.nvidia.enable",
        "kernelcore.nvidia.cudaSupport",
        "kernelcore.nvidia.prime.enable",
        "kernelcore.nvidia.prime.sync",
        "kernelcore.nvidia.prime.offload",
        "kernelcore.nvidia.prime.intelBusId",
        "kernelcore.nvidia.prime.nvidiaBusId"
      ],
      "security_concerns": [
        "Global CUDA environment variables removed, but still potential risks with device access control"
      ],
      "recommendations": [
        "Consider adding more detailed documentation for each option",
        "Review and test NVIDIA Prime configuration thoroughly on hybrid laptops"
      ],
      "lines_of_code": 194,
      "has_documentation": true,
      "analysis_time_ms": 135770,
      "error": null
    },
    {
      "path": "modules/hardware/lenovo-throttled.nix",
      "name": "lenovo-throttled",
      "category": "hardware",
      "purpose": "This module configures thermal management and power limits for Lenovo laptops with specific hardware profiles.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.linuxPackages.turbostat",
        "pkgs.powertop",
        "pkgs.stress-ng"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.hardware.lenovoThrottled.enable",
        "kernelcore.hardware.lenovoThrottled.profile",
        "kernelcore.hardware.lenovoThrottled.tripTemp",
        "kernelcore.hardware.lenovoThrottled.unlockVoltage",
        "kernelcore.hardware.lenovoThrottled.updateRate"
      ],
      "security_concerns": [
        "Attempting to unlock voltage controls may have security implications if BIOS locks are in place."
      ],
      "recommendations": [
        "Consider adding more detailed logging and error handling for the monitoring scripts.",
        "Ensure that the power limits do not exceed safe operating parameters of the hardware."
      ],
      "lines_of_code": 201,
      "has_documentation": true,
      "analysis_time_ms": 145990,
      "error": null
    },
    {
      "path": "modules/hardware/thermal-profiles.nix",
      "name": "thermal-profiles",
      "category": "hardware",
      "purpose": "Manages thermal profiles for hardware components such as Intel processors and NVIDIA GPUs based on user-defined settings and system load.",
      "complexity": "medium",
      "dependencies": [
        "kernelcore.hardware",
        "throttled"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "currentProfile",
        "autoSwitch",
        "temperatureMonitoring"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding more detailed error handling in the script for robustness."
      ],
      "lines_of_code": 358,
      "has_documentation": true,
      "analysis_time_ms": 152130,
      "error": null
    },
    {
      "path": "modules/hardware/intel.nix",
      "name": "intel",
      "category": "hardware",
      "purpose": "Configures various aspects of Intel hardware on NixOS, including CPU power management, graphics settings, and memory optimizations.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.hardware.intel.enable",
        "kernelcore.hardware.intel.powerProfile",
        "kernelcore.hardware.intel.pstate.enable",
        "kernelcore.hardware.intel.pstate.hwpDynamic",
        "kernelcore.hardware.intel.pstate.minFreqPercent",
        "kernelcore.hardware.intel.pstate.maxFreqPercent",
        "kernelcore.hardware.intel.pstate.energyPerformancePreference",
        "kernelcore.hardware.intel.governor.default",
        "kernelcore.hardware.intel.governor.pCores",
        "kernelcore.hardware.intel.governor.eCores",
        "kernelcore.hardware.intel.turboBoost.enable",
        "kernelcore.hardware.intel.turboBoost.maxTemp",
        "kernelcore.hardware.intel.graphics.enable",
        "kernelcore.hardware.intel.graphics.panelSelfRefresh",
        "kernelcore.hardware.intel.graphics.frameBufferCompression",
        "kernelcore.hardware.intel.graphics.enableGuC",
        "kernelcore.hardware.intel.memory.enableTuning",
        "kernelcore.hardware.intel.cache.enableOptimizations"
      ],
      "security_concerns": [
        "PSR (Panel Self-Refresh) can cause stutters and crashes in browsers on Gen12+ CPUs. Ensure the panel supports PSR2 without issues."
      ],
      "recommendations": [
        "Consider adding more detailed documentation for each option to help users understand their impact.",
        "Review the thermal monitoring logic to ensure it does not interfere with other thermal management tools like thermald.",
        "Test the module thoroughly on different hardware configurations to identify and fix any compatibility issues."
      ],
      "lines_of_code": 253,
      "has_documentation": true,
      "analysis_time_ms": 170469,
      "error": null
    },
    {
      "path": "modules/hardware/trezor.nix",
      "name": "trezor",
      "category": "hardware",
      "purpose": "This module configures Trezor hardware wallets for use as SSH authentication agents and provides instructions for setup.",
      "complexity": "low",
      "dependencies": [
        "pkgs.trezor-suite",
        "pkgs.trezor_agent",
        "pkgs.libagent",
        "pkgs.pinentry",
        "pkgs.trezor-udev-rules"
      ],
      "imports": [],
      "options_defined": [
        "hardware.trezor.enable",
        "hardware.trezor.enableSSHAgent"
      ],
      "security_concerns": [
        "Users need to manually add themselves to the 'plugdev' group for access.",
        "No explicit security measures are implemented in the module itself."
      ],
      "recommendations": [
        "Automate adding users to the 'plugdev' group within the module.",
        "Consider implementing additional security measures such as key rotation and backup."
      ],
      "lines_of_code": 162,
      "has_documentation": true,
      "analysis_time_ms": 178834,
      "error": null
    },
    {
      "path": "modules/hardware/wifi-optimization.nix",
      "name": "wifi-optimization",
      "category": "hardware",
      "purpose": "This module optimizes WiFi performance on NixOS systems by configuring kernel parameters, NetworkManager settings, DNS resolution, and system-wide network optimizations.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.hardware.wifi-optimization.enable"
      ],
      "security_concerns": [
        "Disabling MAC address randomization can cause connection issues. Enabling DNS-over-TLS might add latency."
      ],
      "recommendations": [
        "Consider adding more detailed logging to the wifi-monitor service for better diagnostics. Evaluate the necessity of installing debugging/monitoring tools based on system requirements."
      ],
      "lines_of_code": 173,
      "has_documentation": true,
      "analysis_time_ms": 185869,
      "error": null
    },
    {
      "path": "modules/network/dns-resolver.nix",
      "name": "dns-resolver",
      "category": "network",
      "purpose": "Configures DNS resolver settings for network performance and security.",
      "complexity": "medium",
      "dependencies": [
        "systemd-resolved",
        "dnscrypt-proxy2",
        "bind",
        "dnsutils"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "preferredServers",
        "enableDNSSEC",
        "enableDNSCrypt",
        "cacheTTL"
      ],
      "security_concerns": [
        "Potential conflict between DNSCrypt and VPN if both are enabled simultaneously."
      ],
      "recommendations": [
        "Consider implementing a more robust assertion mechanism to handle conflicts between DNSCrypt and VPN."
      ],
      "lines_of_code": 284,
      "has_documentation": true,
      "analysis_time_ms": 193473,
      "error": null
    },
    {
      "path": "modules/network/bridge.nix",
      "name": "bridge",
      "category": "network",
      "purpose": "Manages a NetworkManager bridge interface (br0) with optional IPv6 support.",
      "complexity": "low",
      "dependencies": [
        "networkmanager",
        "gawk",
        "coreutils",
        "util-linux"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "name",
        "uplinkInterface",
        "ipv6.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 84,
      "has_documentation": true,
      "analysis_time_ms": 197648,
      "error": null
    },
    {
      "path": "modules/containers/default.nix",
      "name": "default",
      "category": "containers",
      "purpose": "Imports all container runtime configurations for Docker, Podman, and NixOS containers.",
      "complexity": "low",
      "dependencies": [
        "./docker.nix",
        "./podman.nix",
        "./nixos-containers.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 201096,
      "error": null
    },
    {
      "path": "modules/containers/nixos-containers.nix",
      "name": "nixos-containers",
      "category": "containers",
      "purpose": "Enables NixOS containers support with network and firewall configurations.",
      "complexity": "medium",
      "dependencies": [
        "nixos-container",
        "poetry",
        "nginx",
        "cmake",
        "ninja",
        "iptables",
        "iproute2",
        "tcpdump",
        "wireshark"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.containers.nixos.enable"
      ],
      "security_concerns": [
        "Firewall rules allow forwarding between interfaces, which could be a security risk if not properly managed.",
        "GPU passthrough without proper isolation could pose security risks."
      ],
      "recommendations": [
        "Consider limiting the allowedTCPPorts in the firewall to only those necessary for the containers.",
        "Review and tighten the bindMounts and allowedDevices to ensure minimal privilege escalation."
      ],
      "lines_of_code": 192,
      "has_documentation": true,
      "analysis_time_ms": 209501,
      "error": null
    },
    {
      "path": "modules/containers/podman.nix",
      "name": "podman",
      "category": "containers",
      "purpose": "This module configures Podman container support in NixOS, including enabling Docker compatibility, NVIDIA GPU support, and setting up storage and registries.",
      "complexity": "medium",
      "dependencies": [
        "kernelcore.containers.podman",
        "virtualisation.podman",
        "hardware.nvidia-container-toolkit"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.containers.podman.enable",
        "kernelcore.containers.podman.dockerCompat",
        "kernelcore.containers.podman.enableNvidia"
      ],
      "security_concerns": [
        "Enabling Docker compatibility may expose the system to vulnerabilities associated with Docker.",
        "Using auto-prune without careful consideration can lead to accidental data loss."
      ],
      "recommendations": [
        "Consider disabling Docker compatibility if not needed for compatibility reasons.",
        "Review and adjust auto-prune settings based on specific use cases."
      ],
      "lines_of_code": 111,
      "has_documentation": true,
      "analysis_time_ms": 217599,
      "error": null
    },
    {
      "path": "modules/containers/docker.nix",
      "name": "docker",
      "category": "containers",
      "purpose": "Enables Docker container support in NixOS",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.containers.docker.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 42,
      "has_documentation": false,
      "analysis_time_ms": 220196,
      "error": null
    },
    {
      "path": "modules/debug/default.nix",
      "name": "default",
      "category": "debug",
      "purpose": "Aggregates various debug-related NixOS modules",
      "complexity": "low",
      "dependencies": [
        "./debug-init.nix",
        "./test-init.nix",
        "./tools-integration.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 9,
      "has_documentation": true,
      "analysis_time_ms": 223325,
      "error": null
    },
    {
      "path": "modules/debug/tools-integration.nix",
      "name": "tools-integration",
      "category": "debug",
      "purpose": "Integrates Swissknife Debug Tools into NixOS for professional debugging, monitoring, and system health.",
      "complexity": "low",
      "dependencies": [
        "swissknife-tools"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.swissknife.enable",
        "kernelcore.swissknife.enableSystray"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 51,
      "has_documentation": true,
      "analysis_time_ms": 227118,
      "error": null
    },
    {
      "path": "modules/debug/debug-init.nix",
      "name": "debug-init",
      "category": "debug",
      "purpose": "Provides utilities for debugging configuration issues and performing system analysis on NixOS systems.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 175,
      "has_documentation": true,
      "analysis_time_ms": 231373,
      "error": null
    },
    {
      "path": "modules/debug/test-init.nix",
      "name": "test-init",
      "category": "debug",
      "purpose": "Provides utilities for safely testing NixOS configuration changes by validating flake syntax, performing dry-run builds, checking module imports, and creating backups.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "system.build.testConfig",
        "system.build.testVM",
        "system.build.backupConfig"
      ],
      "security_concerns": [
        "The scripts run with elevated privileges (sudo) without proper validation of input or commands, which could lead to security risks if the scripts are modified maliciously."
      ],
      "recommendations": [
        "Consider adding input validation and sanitization in the scripts to mitigate potential security risks.",
        "Review the scripts for any unintended side effects or command injection vulnerabilities."
      ],
      "lines_of_code": 75,
      "has_documentation": true,
      "analysis_time_ms": 237899,
      "error": null
    },
    {
      "path": "modules/applications/vscode-secure.nix",
      "name": "vscode-secure",
      "category": "applications",
      "purpose": "This module configures Visual Studio Code with Firejail sandboxing and additional security settings.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.firejail",
        "pkgs.vscode"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "enableHardening",
        "allowNetworking",
        "niceLevel",
        "ioSchedulingClass",
        "ioSchedulingPriority",
        "memoryLimit",
        "cpuQuota",
        "allowedPaths",
        "enableMicrosoftTelemetry",
        "extensions"
      ],
      "security_concerns": [
        "Firejail profile may not cover all potential security risks.",
        "Memory and CPU limits are set to fixed values, which might be too restrictive or insufficient."
      ],
      "recommendations": [
        "Review the Firejail profile for completeness and adjust as necessary.",
        "Consider using dynamic resource management instead of fixed limits for better flexibility."
      ],
      "lines_of_code": 298,
      "has_documentation": true,
      "analysis_time_ms": 248366,
      "error": null
    },
    {
      "path": "modules/applications/chromium.nix",
      "name": "chromium",
      "category": "applications",
      "purpose": "This module configures and wraps Chromium with organization-specific rules and settings.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs",
        "config"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package",
        "extraArgs",
        "env",
        "rules"
      ],
      "security_concerns": [
        "The module allows setting environment variables and command line flags, which could potentially be misused if not carefully managed."
      ],
      "recommendations": [
        "Consider adding validation for input options to prevent misuse.",
        "Review the default values and ensure they align with security best practices."
      ],
      "lines_of_code": 355,
      "has_documentation": true,
      "analysis_time_ms": 255565,
      "error": null
    },
    {
      "path": "modules/applications/default.nix",
      "name": "default",
      "category": "applications",
      "purpose": "Imports all application-specific configurations for browsers, editors, and privacy-focused applications.",
      "complexity": "low",
      "dependencies": [
        "./firefox-privacy.nix",
        "./brave-secure.nix",
        "./chromium.nix",
        "./vscodium-secure.nix",
        "./vscode-secure.nix",
        "./zellij.nix",
        "./nemo-full.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 25,
      "has_documentation": true,
      "analysis_time_ms": 260374,
      "error": null
    },
    {
      "path": "modules/applications/brave-secure.nix",
      "name": "brave-secure",
      "category": "applications",
      "purpose": "This module configures Brave browser with Firejail for enhanced security and GPU memory limits.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.firejail",
        "pkgs.brave"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "gpuMemoryLimit",
        "enableHardening",
        "customFlags"
      ],
      "security_concerns": [
        "Firejail configuration might not be comprehensive enough for all security needs.",
        "The use of cgroups for memory limits is indirect and may not always work as expected."
      ],
      "recommendations": [
        "Consider using a more robust security profile for Firejail.",
        "Review the effectiveness of the cgroup memory limit implementation."
      ],
      "lines_of_code": 208,
      "has_documentation": true,
      "analysis_time_ms": 267953,
      "error": null
    },
    {
      "path": "modules/applications/zellij.nix",
      "name": "zellij",
      "category": "applications",
      "purpose": "Manages the installation and configuration of Zellij with optimized settings and automatic cache cleanup.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.zellij",
        "lib",
        "config.kernelcore.applications.zellij"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "autoCleanup",
        "cleanupInterval",
        "maxCacheSizeMB"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 252,
      "has_documentation": true,
      "analysis_time_ms": 273973,
      "error": null
    },
    {
      "path": "modules/applications/vscodium-secure.nix",
      "name": "vscodium-secure",
      "category": "applications",
      "purpose": "This module configures VSCodium with Firejail sandboxing and additional security settings.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.vscodium",
        "pkgs.firejail",
        "pkgs.systemd"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "enableHardening",
        "allowNetworking",
        "niceLevel",
        "ioSchedulingClass",
        "ioSchedulingPriority",
        "memoryLimit",
        "cpuQuota",
        "allowedPaths",
        "extensions"
      ],
      "security_concerns": [
        "Firejail profile may not cover all potential security risks.",
        "Memory and CPU limits are set to fixed values, which might be too restrictive or insufficient."
      ],
      "recommendations": [
        "Review the Firejail profile for completeness and adjust as necessary.",
        "Consider using dynamic resource management instead of fixed limits if possible."
      ],
      "lines_of_code": 282,
      "has_documentation": true,
      "analysis_time_ms": 284586,
      "error": null
    },
    {
      "path": "modules/applications/nemo-full.nix",
      "name": "nemo-full",
      "category": "applications",
      "purpose": "Configures Nemo as a file manager with additional features and plugins.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.nemo",
        "sushi",
        "ffmpegthumbnailer",
        "imagemagick",
        "libgsf",
        "poppler",
        "file-roller",
        "p7zip",
        "unrar",
        "unzip",
        "zip",
        "mediainfo",
        "exiftool"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package",
        "extensions",
        "extraPackages",
        "setDefaultFileManager",
        "plugins"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 148,
      "has_documentation": true,
      "analysis_time_ms": 290960,
      "error": null
    },
    {
      "path": "modules/applications/firefox-privacy.nix",
      "name": "firefox-privacy",
      "category": "applications",
      "purpose": "Configures Firefox with privacy settings and optional hardening features",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "enableGoogleAuthenticator",
        "enableHardening"
      ],
      "security_concerns": [
        "Potential for misconfiguration leading to security vulnerabilities"
      ],
      "recommendations": [
        "Review and test hardening scripts thoroughly before enabling"
      ],
      "lines_of_code": 210,
      "has_documentation": true,
      "analysis_time_ms": 296925,
      "error": null
    },
    {
      "path": "modules/services/config-auditor.nix",
      "name": "config-auditor",
      "category": "services",
      "purpose": "This module provides a configuration auditor tool for NixOS services.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [
        "json"
      ],
      "options_defined": [
        "services.config-auditor.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 149,
      "has_documentation": true,
      "analysis_time_ms": 300505,
      "error": null
    },
    {
      "path": "modules/services/mosh.nix",
      "name": "mosh",
      "category": "services",
      "purpose": "This module configures and enables the Mosh mobile shell server on NixOS, including firewall rules, MOTD, setup instructions, and shell aliases.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.mosh",
        "pkgs.linux.version"
      ],
      "imports": [
        "existing"
      ],
      "options_defined": [
        "kernelcore.services.mosh.enable",
        "kernelcore.services.mosh.openFirewall",
        "kernelcore.services.mosh.portRange.from",
        "kernelcore.services.mosh.portRange.to",
        "kernelcore.services.mosh.enableMotd"
      ],
      "security_concerns": [
        "Mosh relies on SSH for authentication, which should be properly configured. Ensure that the firewall rules are correctly set to allow Mosh traffic."
      ],
      "recommendations": [
        "Consider adding more detailed documentation or examples in the MOTD and setup instructions.",
        "Ensure that the SSH configuration is secure and up-to-date."
      ],
      "lines_of_code": 248,
      "has_documentation": true,
      "analysis_time_ms": 310444,
      "error": null
    },
    {
      "path": "modules/services/gpu-orchestration.nix",
      "name": "gpu-orchestration",
      "category": "services",
      "purpose": "Manages GPU resource orchestration between systemd services and Docker containers based on user-defined modes.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.linuxPackages.nvidia_x11",
        "pkgs.docker"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.services.gpu-orchestration.enable",
        "kernelcore.services.gpu-orchestration.defaultMode"
      ],
      "security_concerns": [
        "The scripts run with sudo, which could pose security risks if not properly managed."
      ],
      "recommendations": [
        "Consider using a more granular approach to permissions for the scripts that require sudo access.",
        "Add documentation on how to use and manage GPU modes effectively."
      ],
      "lines_of_code": 252,
      "has_documentation": true,
      "analysis_time_ms": 319680,
      "error": null
    },
    {
      "path": "modules/services/default.nix",
      "name": "default",
      "category": "services",
      "purpose": "Configures Prometheus and Grafana services on a NixOS system",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "services.prometheus.enable",
        "services.prometheus.port",
        "services.prometheus.exporters.node.enable",
        "services.prometheus.exporters.node.port",
        "services.prometheus.scrapeConfigs",
        "services.grafana.enable",
        "services.grafana.settings.server.domain",
        "services.grafana.settings.server.http_port"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider enabling the DCGM exporter if available in Nixpkgs for GPU monitoring"
      ],
      "lines_of_code": 40,
      "has_documentation": true,
      "analysis_time_ms": 325591,
      "error": null
    },
    {
      "path": "modules/services/mobile-workspace.nix",
      "name": "mobile-workspace",
      "category": "services",
      "purpose": "This module configures an isolated mobile workspace for iPhone/tablet access on NixOS.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "username",
        "workspaceDir",
        "allowedCommands",
        "sshKeys",
        "sharedDirs",
        "enableGitAccess"
      ],
      "security_concerns": [
        "Limited to workspace directory, no sudo privileges, no access to other users' files, all activities are logged"
      ],
      "recommendations": [
        "Consider restricting the list of allowed commands further for security"
      ],
      "lines_of_code": 368,
      "has_documentation": true,
      "analysis_time_ms": 332789,
      "error": null
    },
    {
      "path": "modules/services/offload-server.nix",
      "name": "offload-server",
      "category": "services",
      "purpose": "Configures an NixOS system as a build offload server with SSH access and optional NFS exports.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "services.offload-server.enable",
        "services.offload-server.cachePort",
        "services.offload-server.builderUser",
        "services.offload-server.cacheKeyPath",
        "services.offload-server.enableNFS"
      ],
      "security_concerns": [
        "SSH keys are hardcoded, which is insecure. NFS exports without proper security measures can expose sensitive data."
      ],
      "recommendations": [
        "Use environment variables or secrets for SSH keys. Configure NFS with appropriate security options like root squashing."
      ],
      "lines_of_code": 335,
      "has_documentation": true,
      "analysis_time_ms": 341139,
      "error": null
    },
    {
      "path": "modules/services/mcp-server.nix",
      "name": "mcp-server",
      "category": "services",
      "purpose": "Manages the SecureLLM Bridge MCP Server as a systemd user service on NixOS",
      "complexity": "low",
      "dependencies": [
        "pkgs.securellm-mcp",
        "pkgs.jq",
        "pkgs.sqlite"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "daemon.logLevel",
        "daemon.restartOnFailure",
        "user",
        "dataDir",
        "package",
        "autoConfigureClaudeDesktop"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 321,
      "has_documentation": true,
      "analysis_time_ms": 348072,
      "error": null
    },
    {
      "path": "modules/services/scripts.nix",
      "name": "scripts",
      "category": "services",
      "purpose": "Defines shell aliases for Docker ML containers and system shortcuts in NixOS environments",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 23,
      "has_documentation": true,
      "analysis_time_ms": 351105,
      "error": null
    },
    {
      "path": "modules/services/laptop-offload-client.nix",
      "name": "laptop-offload-client",
      "category": "services",
      "purpose": "Configures a NixOS laptop to offload builds and storage to a desktop server.",
      "complexity": "low",
      "dependencies": [
        "nfs-utils",
        "pkgs.lib.mkDefault"
      ],
      "imports": [],
      "options_defined": [
        "desktopIP",
        "laptopIP",
        "builderKeyPath"
      ],
      "security_concerns": [
        "SSH key is stored in plaintext on the laptop, which could be a security risk if the laptop is compromised. The SSH key should be protected with proper permissions and ideally not stored on the local machine."
      ],
      "recommendations": [
        "Consider using a more secure method for storing and managing SSH keys, such as using a hardware security module or a secure vault service."
      ],
      "lines_of_code": 367,
      "has_documentation": true,
      "analysis_time_ms": 359790,
      "error": null
    },
    {
      "path": "modules/services/laptop-builder-client.nix",
      "name": "laptop-builder-client",
      "category": "services",
      "purpose": "Configures a laptop as a remote build client for NixOS systems.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "desktopIP",
        "builderKeyPath",
        "maxJobs"
      ],
      "security_concerns": [
        "disables strict host key checking, which can lead to man-in-the-middle attacks"
      ],
      "recommendations": [
        "consider enabling strict host key checking for security"
      ],
      "lines_of_code": 145,
      "has_documentation": true,
      "analysis_time_ms": 365193,
      "error": null
    },
    {
      "path": "modules/system/io-scheduler.nix",
      "name": "io-scheduler",
      "category": "system",
      "purpose": "Optimizes I/O performance and latency on NixOS systems by configuring ZRAM swap, IO schedulers, kernel virtual memory settings, systemd journaling, and global limits.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "zramSwap",
        "services.udev.extraRules",
        "boot.kernel.sysctl",
        "services.journald.extraConfig"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 66,
      "has_documentation": true,
      "analysis_time_ms": 370267,
      "error": null
    },
    {
      "path": "modules/system/default.nix",
      "name": "default",
      "category": "system",
      "purpose": "Aggregates various system-related NixOS modules into a single configuration.",
      "complexity": "low",
      "dependencies": [
        "./aliases.nix",
        "./binary-cache.nix",
        "./emergency-monitor.nix",
        "./memory.nix",
        "./ml-gpu-users.nix",
        "./nix.nix",
        "./services.nix",
        "./ssh-config.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 14,
      "has_documentation": true,
      "analysis_time_ms": 374889,
      "error": null
    },
    {
      "path": "modules/system/binary-cache.nix",
      "name": "binary-cache",
      "category": "system",
      "purpose": "Configures NixOS to use custom binary caches for faster package downloads.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.system.binary-cache.enable",
        "kernelcore.system.binary-cache.local.enable",
        "kernelcore.system.binary-cache.local.url",
        "kernelcore.system.binary-cache.local.priority",
        "kernelcore.system.binary-cache.local.requireConnectivity",
        "kernelcore.system.binary-cache.remote.enable",
        "kernelcore.system.binary-cache.remote.substituers",
        "kernelcore.system.binary-cache.remote.trustedPublicKeys"
      ],
      "security_concerns": [
        "The module does not validate the security of remote caches, which could expose the system to man-in-the-middle attacks if not properly configured."
      ],
      "recommendations": [
        "Consider adding validation for remote cache URLs and public keys to ensure they are trusted."
      ],
      "lines_of_code": 138,
      "has_documentation": true,
      "analysis_time_ms": 383685,
      "error": null
    },
    {
      "path": "modules/system/ml-gpu-users.nix",
      "name": "ml-gpu-users",
      "category": "system",
      "purpose": "Manages centralized ML/GPU user and group management for specific services.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.system.ml-gpu-users.enable"
      ],
      "security_concerns": [
        "The module does not include any security hardening measures, such as password policies or restricted shell access."
      ],
      "recommendations": [
        "Consider adding security options like setting up a restricted shell for the users and implementing password policies."
      ],
      "lines_of_code": 61,
      "has_documentation": true,
      "analysis_time_ms": 388158,
      "error": null
    },
    {
      "path": "modules/system/services.nix",
      "name": "services",
      "category": "system",
      "purpose": "Configures systemd services for Docker image pre-pulling and Ollama service with GPU access and centralized storage.",
      "complexity": "low",
      "dependencies": [
        "pkgs.docker",
        "config.kernelcore.ml.models-storage"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "DynamicUser is disabled, which might pose security risks if not properly managed.",
        "ReadWritePaths are granted to a specific directory, which could be risky if not secured properly."
      ],
      "recommendations": [
        "Consider using DynamicUser for better security and manage supplementary groups in a centralized manner."
      ],
      "lines_of_code": 57,
      "has_documentation": true,
      "analysis_time_ms": 393578,
      "error": null
    },
    {
      "path": "modules/system/ssh-config.nix",
      "name": "ssh-config",
      "category": "system",
      "purpose": "Manages SSH client configuration and key management for multiple identities and hosts.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ssh.enable",
        "kernelcore.ssh.sshDir",
        "kernelcore.ssh.personalKey",
        "kernelcore.ssh.orgKey",
        "kernelcore.ssh.serverKey",
        "kernelcore.ssh.gitlabKey",
        "kernelcore.ssh.serverHost",
        "kernelcore.ssh.serverUser"
      ],
      "security_concerns": [
        "ForwardAgent is disabled by default, which may limit security for some use cases.",
        "knownHosts entries are hardcoded and do not support dynamic updates."
      ],
      "recommendations": [
        "Consider enabling ForwardAgent if necessary for certain workflows.",
        "Use dynamic known_hosts management or a more flexible configuration approach."
      ],
      "lines_of_code": 365,
      "has_documentation": true,
      "analysis_time_ms": 402898,
      "error": null
    },
    {
      "path": "modules/system/aliases.nix",
      "name": "aliases",
      "category": "system",
      "purpose": "Installs necessary packages and scripts for system configuration.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.systemPackages",
        "environment.etc",
        "users.users.kernelcore.extraGroups"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 32,
      "has_documentation": true,
      "analysis_time_ms": 405883,
      "error": null
    },
    {
      "path": "modules/system/memory.nix",
      "name": "memory",
      "category": "system",
      "purpose": "This module configures memory management and optimization settings for a NixOS system, including kernel parameters, early OOM killer, ZRAM swap, traditional swap file, log rotation, and memory pressure relief services.",
      "complexity": "high",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.system.memory.optimizations.enable",
        "kernelcore.system.memory.zram.enable"
      ],
      "security_concerns": [
        "The early OOM killer is configured with aggressive settings that may impact system stability and performance.",
        "The memory pressure relief script runs as a root service, which could pose security risks if not properly managed."
      ],
      "recommendations": [
        "Review the early OOM killer thresholds to ensure they do not cause unnecessary process termination.",
        "Consider limiting the scope of the memory pressure relief script to avoid unintended side effects.",
        "Ensure that all services and timers are properly secured and monitored."
      ],
      "lines_of_code": 159,
      "has_documentation": true,
      "analysis_time_ms": 415196,
      "error": null
    },
    {
      "path": "modules/system/nix.nix",
      "name": "nix",
      "category": "system",
      "purpose": "Configures Nix daemon settings for performance optimization and experimental features",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.system.nix.optimizations.enable",
        "kernelcore.system.nix.experimental-features.enable"
      ],
      "security_concerns": [
        "Allowing local git+file URIs for development could expose the system to security risks if not properly managed"
      ],
      "recommendations": [
        "Consider setting a more restrictive timeout value for stuck builds to avoid potential resource exhaustion"
      ],
      "lines_of_code": 94,
      "has_documentation": true,
      "analysis_time_ms": 420705,
      "error": null
    },
    {
      "path": "modules/system/emergency-monitor.nix",
      "name": "emergency-monitor",
      "category": "system",
      "purpose": "This module configures a system emergency monitoring service that checks for critical conditions like high swap usage, CPU temperature, and load average, and automatically intervenes or logs warnings based on thresholds.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "system.emergency.enable",
        "system.emergency.swapThreshold",
        "system.emergency.tempThreshold",
        "system.emergency.loadThreshold",
        "system.emergency.autoIntervene"
      ],
      "security_concerns": [
        "The module grants NOPASSWD sudo permissions to the 'kernelcore' user for running emergency scripts and killing processes, which could be a security risk if not properly managed."
      ],
      "recommendations": [
        "Consider limiting the sudo privileges granted to the 'kernelcore' user to only necessary commands and ensure that the emergency scripts are secure and do not perform harmful actions."
      ],
      "lines_of_code": 210,
      "has_documentation": true,
      "analysis_time_ms": 429965,
      "error": null
    },
    {
      "path": "modules/desktop/default.nix",
      "name": "default",
      "category": "desktop",
      "purpose": "Aggregates and imports various desktop environments for NixOS",
      "complexity": "low",
      "dependencies": [
        "i3-lightweight.nix",
        "hyprland.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider adding more desktop environment modules"
      ],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 433092,
      "error": null
    },
    {
      "path": "modules/desktop/i3-lightweight.nix",
      "name": "i3-lightweight",
      "category": "desktop",
      "purpose": "Configures a lightweight desktop environment using the i3 window manager with options for customization and essential GUI applications.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.desktop.i3.enable",
        "kernelcore.desktop.i3.terminal",
        "kernelcore.desktop.i3.launcher",
        "kernelcore.desktop.i3.statusBar",
        "kernelcore.desktop.i3.enableCompositor",
        "kernelcore.desktop.i3.screenLockCommand"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding options for alternative audio backends like PipeWire for better pro audio support.",
        "Review and update dependencies to ensure they are up-to-date and secure."
      ],
      "lines_of_code": 567,
      "has_documentation": true,
      "analysis_time_ms": 441348,
      "error": null
    },
    {
      "path": "modules/desktop/hyprland.nix",
      "name": "hyprland",
      "category": "desktop",
      "purpose": "Configures a pure Wayland desktop environment using Hyprland as the compositor.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.hyprland",
        "xdg-desktop-portal-hyprland",
        "nvidia-driver",
        "waybar",
        "wofi",
        "mako",
        "libnotify",
        "grim",
        "slurp",
        "swappy",
        "wf-recorder",
        "wl-clipboard",
        "cliphist",
        "wlogout",
        "swaybg",
        "nemo",
        "pavucontrol",
        "networkmanagerapplet",
        "blueman",
        "btop",
        "playerctl",
        "brightnessctl",
        "qt5.qtwayland",
        "qt6.qtwayland",
        "libsForQt5.qtstyleplugins",
        "adwaita-qt",
        "adwaita-qt6",
        "gtk3",
        "gtk4",
        "catppuccin-cursors.macchiatoBlue"
      ],
      "imports": [],
      "options_defined": [
        "services.hyprland-desktop.enable",
        "services.hyprland-desktop.nvidia"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 274,
      "has_documentation": true,
      "analysis_time_ms": 454617,
      "error": null
    },
    {
      "path": "modules/ml/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Aggregates various ML-related modules for NixOS",
      "complexity": "low",
      "dependencies": [
        "./infrastructure",
        "./services",
        "./orchestration",
        "./applications",
        "./integrations"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 30,
      "has_documentation": true,
      "analysis_time_ms": 458000,
      "error": null
    },
    {
      "path": "modules/security/keyring.nix",
      "name": "keyring",
      "category": "security",
      "purpose": "Configures keyring support with GNOME Keyring and integrates it with KeePassXC for credential management.",
      "complexity": "medium",
      "dependencies": [
        "gnome-keyring",
        "libsecret",
        "libgnome-keyring",
        "seahorse",
        "keepassxc"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "enableGUI",
        "enableKeePassXCIntegration",
        "autoUnlock"
      ],
      "security_concerns": [
        "Keyring password = login password, which may compromise security if the login password is weak"
      ],
      "recommendations": [
        "Consider using a dedicated keyring password for better security"
      ],
      "lines_of_code": 194,
      "has_documentation": true,
      "analysis_time_ms": 464992,
      "error": null
    },
    {
      "path": "modules/security/network.nix",
      "name": "network",
      "category": "security",
      "purpose": "Configures network settings including host name, NetworkManager, and firewall rules.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "networking.hostName",
        "networking.networkmanager.enable",
        "networking.firewall.enable",
        "networking.firewall.allowedTCPPorts",
        "networking.firewall.trustedInterfaces",
        "networking.firewall.extraCommands"
      ],
      "security_concerns": [
        "The firewall rules are limited and may not be sufficient for a production environment.",
        "Commented-out ports could potentially be enabled if uncommented, introducing security risks."
      ],
      "recommendations": [
        "Consider adding more specific firewall rules based on the actual services running on the system.",
        "Ensure that all commented-out ports are removed or properly secured before enabling them."
      ],
      "lines_of_code": 51,
      "has_documentation": true,
      "analysis_time_ms": 472763,
      "error": null
    },
    {
      "path": "modules/security/ssh.nix",
      "name": "ssh",
      "category": "security",
      "purpose": "This module configures SSH on NixOS with security hardening options and optional two-factor authentication using Google Authenticator.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.google-authenticator"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.ssh.enable",
        "kernelcore.security.ssh.enable2FA"
      ],
      "security_concerns": [
        "The 'nullok' option allows SSH without 2FA if .google_authenticator doesn't exist, which could be a security risk during rollout."
      ],
      "recommendations": [
        "Consider removing the 'nullok' option to enforce 2FA for all users."
      ],
      "lines_of_code": 207,
      "has_documentation": true,
      "analysis_time_ms": 480245,
      "error": null
    },
    {
      "path": "modules/security/dev-directory-hardening.nix",
      "name": "dev-directory-hardening",
      "category": "security",
      "purpose": "Provides security hardening for a development directory by setting permissions, enabling encryption, auditing, integrity monitoring, and automated backups.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.ecryptfs",
        "pkgs.ecryptfs-helper",
        "pkgs.aide",
        "pkgs.git-crypt",
        "pkgs.gnutar",
        "pkgs.gnupg"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.dev-directory.enable",
        "kernelcore.security.dev-directory.user",
        "kernelcore.security.dev-directory.path",
        "kernelcore.security.dev-directory.enableEncryption",
        "kernelcore.security.dev-directory.enableAudit",
        "kernelcore.security.dev-directory.enableBackup",
        "kernelcore.security.dev-directory.backupInterval",
        "kernelcore.security.dev-directory.allowedProcesses"
      ],
      "security_concerns": [
        "eCryptfs setup requires manual intervention and password on login.",
        "AIDE configuration excludes build artifacts, which might be too noisy."
      ],
      "recommendations": [
        "Document the steps for setting up eCryptfs manually.",
        "Consider excluding less critical files from AIDE monitoring to reduce noise."
      ],
      "lines_of_code": 444,
      "has_documentation": true,
      "analysis_time_ms": 492921,
      "error": null
    },
    {
      "path": "modules/security/kernel.nix",
      "name": "kernel",
      "category": "security",
      "purpose": "This module configures kernel security hardening options in NixOS.",
      "complexity": "medium",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.security.kernel.enable"
      ],
      "security_concerns": [
        "The use of 'lockdown=confidentiality' may limit system flexibility and compatibility with certain applications."
      ],
      "recommendations": [
        "Consider removing or commenting out unused kernel modules to reduce attack surface.",
        "Review the impact of 'lockdown=confidentiality' on system functionality before enabling it."
      ],
      "lines_of_code": 137,
      "has_documentation": true,
      "analysis_time_ms": 499339,
      "error": null
    },
    {
      "path": "modules/security/packages.nix",
      "name": "packages",
      "category": "security",
      "purpose": "Installs various security and audit tools on a NixOS system.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "kernelcore.security.packages.enable"
      ],
      "security_concerns": [
        "Allowing wheel group users to run Lynis audits without password can pose a security risk."
      ],
      "recommendations": [
        "Consider removing the NOPASSWD option for Lynis to enhance security."
      ],
      "lines_of_code": 84,
      "has_documentation": true,
      "analysis_time_ms": 503904,
      "error": null
    },
    {
      "path": "modules/security/audit.nix",
      "name": "audit",
      "category": "security",
      "purpose": "Enables and configures security auditing, logging, AppArmor, Journald, and credential storage on a NixOS system.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.audit.enable"
      ],
      "security_concerns": [
        "The commented-out rules for monitoring specific syscalls could potentially be exploited if enabled without proper configuration."
      ],
      "recommendations": [
        "Uncomment and thoroughly test the commented-out audit rules to ensure they do not introduce security vulnerabilities.",
        "Consider adding more detailed logging rules based on specific security requirements.",
        "Review and adjust Journald settings according to system resource availability and performance needs."
      ],
      "lines_of_code": 89,
      "has_documentation": true,
      "analysis_time_ms": 511006,
      "error": null
    },
    {
      "path": "modules/security/default.nix",
      "name": "default",
      "category": "security",
      "purpose": "Imports all security hardening configurations for NixOS",
      "complexity": "low",
      "dependencies": [
        "./boot.nix",
        "./kernel.nix",
        "./compiler-hardening.nix",
        "./hardening.nix",
        "./network.nix",
        "./pam.nix",
        "./ssh.nix",
        "./nix-daemon.nix",
        "./packages.nix",
        "./keyring.nix",
        "./aide.nix",
        "./clamav.nix",
        "./audit.nix",
        "./auto-upgrade.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "Compiler hardening is currently disabled for Nix 2.18+ compatibility, which may reduce security",
        "The order of imports matters; they should be imported last in flake.nix to ensure highest priority and can override other module configurations"
      ],
      "recommendations": [
        "Enable compiler hardening if possible",
        "Verify the order of imports in flake.nix as per the comment"
      ],
      "lines_of_code": 39,
      "has_documentation": true,
      "analysis_time_ms": 520499,
      "error": null
    },
    {
      "path": "modules/security/auto-upgrade.nix",
      "name": "auto-upgrade",
      "category": "security",
      "purpose": "Enables automatic system updates using NixOS's built-in auto-upgrade feature.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.auto-upgrade.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 37,
      "has_documentation": true,
      "analysis_time_ms": 523638,
      "error": null
    },
    {
      "path": "modules/security/nix-daemon.nix",
      "name": "nix-daemon",
      "category": "security",
      "purpose": "This module configures Nix daemon security settings, including enabling sandboxing, setting up binary caches, and configuring package security policies.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.nix.enable",
        "kernelcore.security.sandbox-fallback",
        "kernelcore.security.nix.primaryCache",
        "kernelcore.security.nix.primaryCacheKey",
        "kernelcore.security.nix.extraSubstituters",
        "kernelcore.security.nix.extraTrustedKeys",
        "kernelcore.security.nix.connectTimeout",
        "kernelcore.security.nix.stalledDownloadTimeout"
      ],
      "security_concerns": [
        "The module allows setting up binary caches, which could be a security risk if not properly managed.",
        "It enables sandboxing but does not specify the type of sandbox (e.g., user namespace or chroot), which might have different implications for security."
      ],
      "recommendations": [
        "Specify the type of sandbox explicitly to ensure it meets the desired security requirements.",
        "Review and validate the list of allowed URIs to ensure they are necessary and secure.",
        "Consider implementing additional security measures such as using a dedicated Nix user or group for builds."
      ],
      "lines_of_code": 154,
      "has_documentation": true,
      "analysis_time_ms": 536159,
      "error": null
    },
    {
      "path": "modules/security/aide.nix",
      "name": "aide",
      "category": "security",
      "purpose": "This module configures and manages the AIDE (Advanced Intrusion Detection Environment) on NixOS systems.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.aide",
        "pkgs.coreutils",
        "pkgs.bash",
        "pkgs.mailutils"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.aide.enable",
        "kernelcore.security.aide.databasePath",
        "kernelcore.security.aide.configFile",
        "kernelcore.security.aide.checkSchedule",
        "kernelcore.security.aide.alertEmail"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 279,
      "has_documentation": true,
      "analysis_time_ms": 543802,
      "error": null
    },
    {
      "path": "modules/security/clamav.nix",
      "name": "clamav",
      "category": "security",
      "purpose": "Configures and enables ClamAV antivirus scanning on a NixOS system",
      "complexity": "low",
      "dependencies": [
        "pkgs.clamav",
        "pkgs.sudo",
        "pkgs.bash"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.clamav.enable"
      ],
      "security_concerns": [
        "Allowing users in the wheel group to run freshclam and clamscan without password",
        "Using a wrapper script for freshclam with sudo, which could be risky if not properly managed"
      ],
      "recommendations": [
        "Consider using more restrictive sudo rules for the wheel group",
        "Review and test the wrapper script thoroughly before deploying it in production"
      ],
      "lines_of_code": 106,
      "has_documentation": true,
      "analysis_time_ms": 550816,
      "error": null
    },
    {
      "path": "modules/security/boot.nix",
      "name": "boot",
      "category": "security",
      "purpose": "Enables systemd-boot as the bootloader and configures kernel parameters for improved boot performance and security.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "boot.loader.systemd-boot.enable",
        "boot.loader.efi.canTouchEfiVariables",
        "boot.kernelParams",
        "boot.initrd.luks.devices.luks-fc184620-7703-4f89-9177-54e39e24a918.device"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 21,
      "has_documentation": false,
      "analysis_time_ms": 556547,
      "error": null
    },
    {
      "path": "modules/security/compiler-hardening.nix",
      "name": "compiler-hardening",
      "category": "security",
      "purpose": "Enables compiler hardening flags to enhance the security of compiled software",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The commented-out overlay approach may cause compatibility issues with newer Nix versions"
      ],
      "recommendations": [
        "Re-enable compiler hardening using the recommended per-package or nixpkgs.config.hardening method"
      ],
      "lines_of_code": 39,
      "has_documentation": true,
      "analysis_time_ms": 560743,
      "error": null
    },
    {
      "path": "modules/security/hardening-template.nix",
      "name": "hardening-template",
      "category": "security",
      "purpose": "This module provides a comprehensive set of hardening configurations for NixOS systems, focusing on security aspects such as sandboxing, compiler flags, PAM settings, kernel parameters, and more.",
      "complexity": "high",
      "dependencies": [
        "nixpkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "nix.settings",
        "nixpkgs.config",
        "nixpkgs.overlays",
        "environment.variables",
        "security.pam.loginLimits",
        "boot.kernelPackages",
        "boot.kernelParams",
        "boot.kernel.sysctl",
        "security.lockKernelModules",
        "security.protectKernelImage",
        "security.apparmor.enable",
        "security.audit.enable",
        "security.sudo.enable",
        "security.wrappers",
        "systemd.coredump.enable",
        "networking.firewall",
        "services.journald.extraConfig"
      ],
      "security_concerns": [
        "The use of `slab_nomerge` and other kernel parameters may have unintended consequences.",
        "The `allowUnfree`, `allowBroken`, and `allowInsecure` settings in `nixpkgs.config` might compromise the security of the system if not properly managed."
      ],
      "recommendations": [
        "Review the impact of `slab_nomerge` and other kernel parameters before enabling them.",
        "Ensure that `allowUnfree`, `allowBroken`, and `allowInsecure` are set to `false` unless absolutely necessary for development purposes."
      ],
      "lines_of_code": 243,
      "has_documentation": true,
      "analysis_time_ms": 575785,
      "error": null
    },
    {
      "path": "modules/security/hardening.nix",
      "name": "hardening",
      "category": "security",
      "purpose": "Enables various security hardening features across different subsystems in NixOS",
      "complexity": "low",
      "dependencies": [
        "./nix-daemon.nix",
        "./pam.nix",
        "./ssh.nix",
        "./kernel.nix",
        "./audit.nix",
        "./aide.nix",
        "./clamav.nix",
        "./packages.nix",
        "./auto-upgrade.nix"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.hardening.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 42,
      "has_documentation": true,
      "analysis_time_ms": 581388,
      "error": null
    },
    {
      "path": "modules/security/pam.nix",
      "name": "pam",
      "category": "security",
      "purpose": "This module configures PAM (Pluggable Authentication Modules) and related security settings on a NixOS system.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.security.pam.enable"
      ],
      "security_concerns": [
        "The password quality requirements are set to allow very weak passwords (minlen=14, dcredit=-1, ucredit=-1, ocredit=-1, lcredit=-1). This could be a security risk.",
        "The system login policies do not enforce strong password expiration or complexity rules."
      ],
      "recommendations": [
        "Increase the minimum password length and tighten character requirements in `security.pam.services.passwd.text`.",
        "Consider implementing more stringent password expiration policies in `security.loginDefs.settings`."
      ],
      "lines_of_code": 83,
      "has_documentation": true,
      "analysis_time_ms": 589156,
      "error": null
    },
    {
      "path": "modules/virtualization/macos-kvm.nix",
      "name": "macos-kvm",
      "category": "virtualization",
      "purpose": "Provides a declarative way to manage macOS VMs using QEMU/KVM with features like auto-resource detection, GPU passthrough, and SSH automation.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.python3",
        "pkgs.dmg2img",
        "pkgs.curl",
        "pkgs.qemu",
        "pkgs.OVMF"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.virtualization.macos-kvm.enable",
        "kernelcore.virtualization.macos-kvm.workDir",
        "kernelcore.virtualization.macos-kvm.diskSizeGB",
        "kernelcore.virtualization.macos-kvm.autoDetectResources",
        "kernelcore.virtualization.macos-kvm.maxCores",
        "kernelcore.virtualization.macos-kvm.maxMemoryGB",
        "kernelcore.virtualization.macos-kvm.cores",
        "kernelcore.virtualization.macos-kvm.memoryGB",
        "kernelcore.virtualization.macos-kvm.cpuModel",
        "kernelcore.virtualization.macos-kvm.diskCache",
        "kernelcore.virtualization.macos-kvm.diskAio",
        "kernelcore.virtualization.macos-kvm.sshPort",
        "kernelcore.virtualization.macos-kvm.vncPort",
        "kernelcore.virtualization.macos-kvm.macAddress",
        "kernelcore.virtualization.macos-kvm.display.virtioGl"
      ],
      "security_concerns": [
        "The scripts use `curl` to download files from the internet without verifying SSL certificates, which can be a security risk.",
        "The SSH script does not enable public key authentication, relying solely on password-based authentication."
      ],
      "recommendations": [
        "Use `nix-prefetch-url` to fetch and verify the integrity of the macOS installer scripts and files.",
        "Enable public key authentication for SSH access instead of using passwords.",
        "Consider adding options to configure network settings and other QEMU parameters for more flexibility."
      ],
      "lines_of_code": 492,
      "has_documentation": true,
      "analysis_time_ms": 609580,
      "error": null
    },
    {
      "path": "modules/virtualization/vmctl.nix",
      "name": "vmctl",
      "category": "virtualization",
      "purpose": "This module configures and installs the vmctl helper CLI for managing declarative VMs in NixOS.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.libvirt",
        "pkgs.virt-manager",
        "pkgs.jq",
        "pkgs.coreutils",
        "pkgs.gnugrep",
        "pkgs.gawk",
        "pkgs.qemu",
        "pkgs.libarchive",
        "pkgs.dialog"
      ],
      "imports": [
        "status",
        "<path>",
        "discovered",
        "\\\"$img\\\"",
        "<image-path>",
        "\\",
        "\"$@\""
      ],
      "options_defined": [
        "enable",
        "verbose",
        "dryRun"
      ],
      "security_concerns": [
        "The module allows the creation of VMs with names that may contain special characters, which could be exploited for security issues if not properly sanitized."
      ],
      "recommendations": [
        "Implement input validation and sanitization for VM names to prevent potential security vulnerabilities.",
        "Consider adding more detailed logging options to help with debugging and auditing."
      ],
      "lines_of_code": 959,
      "has_documentation": true,
      "analysis_time_ms": 620183,
      "error": null
    },
    {
      "path": "modules/virtualization/default.nix",
      "name": "default",
      "category": "virtualization",
      "purpose": "Imports all virtualization configurations",
      "complexity": "low",
      "dependencies": [
        "./vms.nix",
        "./vmctl.nix",
        "./macos-kvm.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 622988,
      "error": null
    },
    {
      "path": "modules/virtualization/vms.nix",
      "name": "vms",
      "category": "virtualization",
      "purpose": "This module configures virtualization settings in NixOS, including enabling QEMU/KVM, virt-manager, and libvirtd for VM management.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.qemu_kvm",
        "pkgs.virtiofsd"
      ],
      "imports": [
        "\\"
      ],
      "options_defined": [
        "kernelcore.virtualization.enable",
        "kernelcore.virtualization.virt-manager",
        "kernelcore.virtualization.libvirtdGroup",
        "kernelcore.virtualization.virtiofs.enable",
        "kernelcore.virtualization.vmBaseDir",
        "kernelcore.virtualization.sourceImageDir",
        "kernelcore.virtualization.vms"
      ],
      "security_concerns": [
        "The module allows non-root users to manage VMs via libvirtd, which could pose security risks if not properly managed."
      ],
      "recommendations": [
        "Consider implementing stricter access controls for the libvirtd group to limit VM management privileges.",
        "Review and update policyKit rules to ensure they align with your organization's security policies."
      ],
      "lines_of_code": 504,
      "has_documentation": true,
      "analysis_time_ms": 633907,
      "error": null
    },
    {
      "path": "modules/_sources/generated.nix",
      "name": "generated",
      "category": "_sources",
      "purpose": "This module defines sources for various software packages using Nix functions like fetchgit and fetchurl.",
      "complexity": "low",
      "dependencies": [
        "fetchgit",
        "fetchurl",
        "fetchFromGitHub",
        "dockerTools"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 39,
      "has_documentation": true,
      "analysis_time_ms": 637440,
      "error": null
    },
    {
      "path": "modules/packages/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Imports and organizes NixOS packages into a modular structure for easy management and debugging.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider adding comments to explain the purpose of each package import.",
        "Review the TODO comment about legacy support and plan for migration."
      ],
      "lines_of_code": 28,
      "has_documentation": true,
      "analysis_time_ms": 641058,
      "error": null
    },
    {
      "path": "modules/packages/appflowy.nix",
      "name": "appflowy",
      "category": "packages",
      "purpose": "This module defines a NixOS package for AppFlowy, an open-source alternative to Notion.",
      "complexity": "low",
      "dependencies": [
        "pkgs.stdenvNoCC.mkDerivation",
        "pkgs.fetchzip",
        "pkgs.makeWrapper",
        "pkgs.copyDesktopItems",
        "pkgs.autoPatchelfHook",
        "pkgs.gtk3",
        "pkgs.keybinder3",
        "pkgs.libnotify",
        "gst_all_1.gstreamer",
        "gst_all_1.gst-plugins-base",
        "gst_all_1.gst-plugins-good",
        "gst_all_1.gst-plugins-bad",
        "pkgs.xdg-user-dirs"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The use of `stripRoot = false` in the fetchzip might expose sensitive information.",
        "The installation phase copies files directly from the source, which could be risky if the source is not trusted."
      ],
      "recommendations": [
        "Consider using a more secure method for fetching the archive, such as HTTPS with a verified certificate.",
        "Review the `installPhase` to ensure it does not inadvertently expose sensitive information or execute untrusted code."
      ],
      "lines_of_code": 87,
      "has_documentation": true,
      "analysis_time_ms": 652721,
      "error": null
    },
    {
      "path": "modules/soc/default.nix",
      "name": "default",
      "category": "soc",
      "purpose": "Aggregates various NixOS modules for a comprehensive Security Operations Center (SOC) setup.",
      "complexity": "medium",
      "dependencies": [
        "./options.nix",
        "./tools.nix",
        "./siem/wazuh.nix",
        "./siem/opensearch.nix",
        "./siem/log-aggregator.nix",
        "./ids/suricata.nix",
        "./ids/threat-intel.nix",
        "./edr/edr.nix",
        "./edr/fim.nix",
        "./network/netflow.nix",
        "./network/dns-monitor.nix",
        "./dashboards/grafana.nix",
        "./alerting/alerting.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The module aggregates multiple security components without explicit configuration options, which could lead to misconfiguration or incomplete setups."
      ],
      "recommendations": [
        "Define specific `mkOption` for each component to allow users to configure individual settings.",
        "Add validation and default values for critical options to ensure a robust setup."
      ],
      "lines_of_code": 45,
      "has_documentation": true,
      "analysis_time_ms": 662526,
      "error": null
    },
    {
      "path": "modules/soc/tools.nix",
      "name": "tools",
      "category": "soc",
      "purpose": "Provides a set of shell scripts for monitoring and managing security operations center (SOC) tools on NixOS systems.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The scripts use `systemctl`, `ausearch`, `ss`, `journalctl`, and other system commands, which could be risky if not properly secured or if the user running these scripts has elevated privileges."
      ],
      "recommendations": [
        "Ensure that only authorized users can run these scripts.",
        "Consider implementing proper logging and auditing for these tools to track their usage and potential misuse."
      ],
      "lines_of_code": 375,
      "has_documentation": true,
      "analysis_time_ms": 671179,
      "error": null
    },
    {
      "path": "modules/soc/options.nix",
      "name": "options",
      "category": "soc",
      "purpose": "This module configures a Security Operations Center (SOC) with various settings such as profiles, data retention, network configurations, alerting methods, and threat intelligence.",
      "complexity": "medium",
      "dependencies": [
        "kernelcore",
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "profile",
        "retention.days",
        "retention.maxSizeGB",
        "network.listenAddress",
        "network.adminNetwork",
        "alerting.enable",
        "alerting.slack.enable",
        "alerting.slack.webhookFile",
        "alerting.slack.channel",
        "alerting.email.enable",
        "alerting.email.recipients",
        "alerting.email.smtpServer",
        "alerting.telegram.enable",
        "alerting.telegram.botTokenFile",
        "alerting.telegram.chatId",
        "alerting.discord.enable",
        "alerting.discord.webhookFile",
        "alerting.minSeverity",
        "threatIntel.enable",
        "threatIntel.feeds",
        "threatIntel.updateInterval"
      ],
      "security_concerns": [
        "The use of plaintext configuration options for sensitive information like webhook URLs and bot tokens could pose security risks if not properly encrypted or managed.",
        "The default profile is set to 'minimal', which may not provide sufficient protection for all environments."
      ],
      "recommendations": [
        "Encrypt sensitive configuration options using SOPS or another encryption tool.",
        "Consider providing more detailed documentation on how to securely manage and rotate these secrets.",
        "Evaluate the necessity of enabling all alerting methods, as some might be redundant or unnecessary based on the environment's requirements."
      ],
      "lines_of_code": 171,
      "has_documentation": true,
      "analysis_time_ms": 686355,
      "error": null
    },
    {
      "path": "modules/programs/vmctl.nix",
      "name": "vmctl",
      "category": "programs",
      "purpose": "Manages the installation and configuration of vmctl, a lightweight QEMU VM Manager.",
      "complexity": "low",
      "dependencies": [
        "pkgs.hello",
        "pkgs.qemu",
        "pkgs.qemu_kvm"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package",
        "vms"
      ],
      "security_concerns": [],
      "recommendations": [
        "Re-enable the module when vmctl is available as a flake input."
      ],
      "lines_of_code": 85,
      "has_documentation": true,
      "analysis_time_ms": 690880,
      "error": null
    },
    {
      "path": "modules/programs/phantom.nix",
      "name": "phantom",
      "category": "programs",
      "purpose": "This module integrates Phantom as a flake input for document intelligence, providing options to enable the Phantom AI toolkit, its GTK4 desktop application, and various configuration settings.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.python3Packages.buildPythonApplication",
        "pkgs.wrapGAppsHook4",
        "pkgs.gobject-introspection",
        "pkgs.gtk4",
        "pkgs.libadwaita"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "desktop.enable",
        "aliases.enable",
        "providers.llamacpp.url",
        "providers.ollama.url",
        "vectorDb.path"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding a check for the existence of the source directory to avoid build failures.",
        "Review the `installPhase` script for any potential security risks, such as command injection or file overwrites."
      ],
      "lines_of_code": 169,
      "has_documentation": true,
      "analysis_time_ms": 700261,
      "error": null
    },
    {
      "path": "modules/programs/default.nix",
      "name": "default",
      "category": "programs",
      "purpose": "Enables Sway window manager with XWayland support and imports additional configuration modules for cognitive vault, VM control, and Phantom AI toolkit.",
      "complexity": "low",
      "dependencies": [
        "./cognitive-vault.nix",
        "./vmctl.nix",
        "./phantom.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 12,
      "has_documentation": true,
      "analysis_time_ms": 704104,
      "error": null
    },
    {
      "path": "modules/programs/cognitive-vault.nix",
      "name": "cognitive-vault",
      "category": "programs",
      "purpose": "Provides configuration for installing and enabling the CognitiveVault password manager.",
      "complexity": "low",
      "dependencies": [
        "pkgs.hello"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package"
      ],
      "security_concerns": [],
      "recommendations": [
        "Re-enable when cognitive-vault is available as flake input"
      ],
      "lines_of_code": 31,
      "has_documentation": true,
      "analysis_time_ms": 707407,
      "error": null
    },
    {
      "path": "modules/audio/default.nix",
      "name": "default",
      "category": "audio",
      "purpose": "Aggregates audio-related NixOS modules for production and video production environments.",
      "complexity": "low",
      "dependencies": [
        "./production.nix",
        "./video-production.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 8,
      "has_documentation": true,
      "analysis_time_ms": 710356,
      "error": null
    },
    {
      "path": "modules/audio/video-production.nix",
      "name": "video-production",
      "category": "audio",
      "purpose": "Configures an NixOS environment for professional video production using OBS Studio and NVIDIA hardware acceleration.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "config.modules.audio.videoProduction"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "enableNVENC",
        "fixHeadphoneMute",
        "lowLatency"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding a section for handling audio latency settings in OBS Studio.",
        "Ensure that the `obs-nvenc` script is tested on different hardware configurations to avoid crashes."
      ],
      "lines_of_code": 402,
      "has_documentation": true,
      "analysis_time_ms": 718372,
      "error": null
    },
    {
      "path": "modules/audio/production.nix",
      "name": "production",
      "category": "audio",
      "purpose": "Configures an audio production environment with various tools and plugins.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "jackAudio",
        "plugins",
        "synthesizers",
        "downloaders"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding options for managing audio permissions and firewall rules."
      ],
      "lines_of_code": 646,
      "has_documentation": true,
      "analysis_time_ms": 724424,
      "error": null
    },
    {
      "path": "modules/secrets/aws-bedrock.nix",
      "name": "aws-bedrock",
      "category": "secrets",
      "purpose": "Manages AWS Bedrock credentials and environment variables for a specific user in NixOS",
      "complexity": "low",
      "dependencies": [
        "sops",
        "awscli2"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.secrets.aws-bedrock.enable"
      ],
      "security_concerns": [
        "Sensitive information stored in plaintext files, potential for unauthorized access if not properly secured"
      ],
      "recommendations": [
        "Consider using encrypted environment variables instead of plain text files for sensitive data"
      ],
      "lines_of_code": 108,
      "has_documentation": true,
      "analysis_time_ms": 729632,
      "error": null
    },
    {
      "path": "modules/secrets/tailscale.nix",
      "name": "tailscale",
      "category": "secrets",
      "purpose": "Manages Tailscale secrets using SOPS for encryption and ensures the necessary systemd tmpfiles rules are set up.",
      "complexity": "low",
      "dependencies": [
        "sops",
        "tailscaled"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.secrets.tailscale.enable",
        "kernelcore.secrets.tailscale.secretsFile"
      ],
      "security_concerns": [
        "The secrets file is stored in a potentially world-readable directory, which could expose sensitive information if not properly secured."
      ],
      "recommendations": [
        "Ensure the secrets file is stored in a more secure location that restricts access to only authorized users."
      ],
      "lines_of_code": 59,
      "has_documentation": true,
      "analysis_time_ms": 735369,
      "error": null
    },
    {
      "path": "modules/secrets/default.nix",
      "name": "default",
      "category": "secrets",
      "purpose": "Aggregates various secret management modules for NixOS configurations.",
      "complexity": "low",
      "dependencies": [
        "./api-keys.nix",
        "./aws-bedrock.nix",
        "./sops-config.nix",
        "./tailscale.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 10,
      "has_documentation": true,
      "analysis_time_ms": 738894,
      "error": null
    },
    {
      "path": "modules/secrets/api-keys.nix",
      "name": "api-keys",
      "category": "secrets",
      "purpose": "Manages and loads API keys from encrypted files into the system environment",
      "complexity": "low",
      "dependencies": [
        "pkgs.sops",
        "config.users.users.kernelcore.name"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.secrets.api-keys.enable"
      ],
      "security_concerns": [
        "Sensitive information is stored in plaintext environment variables, which could be exposed if the environment is compromised"
      ],
      "recommendations": [
        "Consider using a more secure method for managing API keys, such as using a secrets management service or encrypted vault"
      ],
      "lines_of_code": 155,
      "has_documentation": true,
      "analysis_time_ms": 745117,
      "error": null
    },
    {
      "path": "modules/secrets/sops-config.nix",
      "name": "sops-config",
      "category": "secrets",
      "purpose": "Manages secrets using SOPS and AGE encryption tools",
      "complexity": "low",
      "dependencies": [
        "sops",
        "age",
        "ssh-to-age"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "secretsPath",
        "ageKeyFile"
      ],
      "security_concerns": [
        "default paths for sensitive data might not be secure enough"
      ],
      "recommendations": [
        "consider using more restrictive permissions for the secrets directory"
      ],
      "lines_of_code": 135,
      "has_documentation": true,
      "analysis_time_ms": 750085,
      "error": null
    },
    {
      "path": "modules/soc/edr/edr.nix",
      "name": "edr",
      "category": "soc",
      "purpose": "This module configures Endpoint Detection & Response (EDR) features in a NixOS system, including process monitoring, network tracking, and behavioral analysis.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.coreutils",
        "pkgs.gawk",
        "pkgs.gnugrep",
        "pkgs.procps",
        "pkgs.iproute2",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.soc.edr.enable",
        "kernelcore.soc.edr.processMonitoring.enable",
        "kernelcore.soc.edr.processMonitoring.suspiciousProcesses",
        "kernelcore.soc.edr.networkTracking.enable",
        "kernelcore.soc.edr.networkTracking.alertOnNewListeners",
        "kernelcore.soc.edr.behavior.enable",
        "kernelcore.soc.edr.behavior.detectPrivEsc",
        "kernelcore.soc.edr.behavior.detectLateralMovement"
      ],
      "security_concerns": [
        "The module uses audit rules to monitor system events, which could potentially impact performance.",
        "The EDR monitoring daemon and process execution logger are run as services, which may require elevated privileges."
      ],
      "recommendations": [
        "Consider adding more sophisticated baseline comparison logic for network connections and running processes.",
        "Implement rate limiting on audit logs to prevent log flooding in high-traffic environments.",
        "Ensure that the EDR monitoring daemon and process execution logger are properly secured and isolated from other system services."
      ],
      "lines_of_code": 266,
      "has_documentation": true,
      "analysis_time_ms": 765822,
      "error": null
    },
    {
      "path": "modules/soc/edr/fim.nix",
      "name": "fim",
      "category": "soc",
      "purpose": "Provides configuration for File Integrity Monitoring (FIM) in a NixOS system, including real-time monitoring and scheduled full scans.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.inotify-tools",
        "pkgs.coreutils",
        "pkgs.findutils",
        "pkgs.openssl",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.soc.edr.fim.enable",
        "kernelcore.soc.edr.fim.monitorPaths",
        "kernelcore.soc.edr.fim.excludePatterns",
        "kernelcore.soc.edr.fim.scanInterval",
        "kernelcore.soc.edr.fim.realtime"
      ],
      "security_concerns": [
        "The module uses inotify for real-time monitoring, which may have performance implications on systems with many files being monitored. The use of a baseline for full scans could potentially be improved to avoid unnecessary re-scans."
      ],
      "recommendations": [
        "Consider adding more detailed logging and alerting mechanisms to improve visibility into FIM events. Evaluate the impact of inotify on system performance and consider alternatives if necessary."
      ],
      "lines_of_code": 277,
      "has_documentation": true,
      "analysis_time_ms": 777436,
      "error": null
    },
    {
      "path": "modules/soc/network/dns-monitor.nix",
      "name": "dns-monitor",
      "category": "soc",
      "purpose": "Enables DNS query monitoring and blocking malicious domains using dnsmasq and systemd services.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "network.dnsMonitor.enable",
        "network.dnsMonitor.logQueries",
        "network.dnsMonitor.blockMalicious",
        "network.dnsMonitor.blocklists"
      ],
      "security_concerns": [
        "Potential for misconfiguration to block legitimate DNS queries, lack of validation of blocklist sources"
      ],
      "recommendations": [
        "Validate blocklist URLs before use",
        "Consider using a more robust method for updating and managing blocklists"
      ],
      "lines_of_code": 104,
      "has_documentation": true,
      "analysis_time_ms": 783662,
      "error": null
    },
    {
      "path": "modules/soc/network/netflow.nix",
      "name": "netflow",
      "category": "soc",
      "purpose": "Manages Netflow collection and export for network visibility",
      "complexity": "low",
      "dependencies": [
        "pkgs.softflowd",
        "pkgs.nfdump"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "interfaces",
        "exportToSiem"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 95,
      "has_documentation": true,
      "analysis_time_ms": 787440,
      "error": null
    },
    {
      "path": "modules/soc/ids/suricata.nix",
      "name": "suricata",
      "category": "soc",
      "purpose": "Configures Suricata IDS/IPS with performance optimizations and logging settings",
      "complexity": "medium",
      "dependencies": [
        "pkgs.suricata",
        "pkgs.ethtool"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "mode",
        "interfaces",
        "rules.enableETOpen",
        "rules.enableETBotcc",
        "rules.customRules",
        "rules.updateInterval",
        "performance.threads",
        "performance.memcap",
        "performance.afPacket",
        "performance.afPacketBufferSize",
        "logging.eveJson",
        "logging.fastLog",
        "logging.pcapLog"
      ],
      "security_concerns": [
        "None identified in the provided code"
      ],
      "recommendations": [
        "Consider adding more detailed logging options for troubleshooting",
        "Review rule update interval and ensure it aligns with organizational needs"
      ],
      "lines_of_code": 508,
      "has_documentation": true,
      "analysis_time_ms": 796671,
      "error": null
    },
    {
      "path": "modules/soc/ids/threat-intel.nix",
      "name": "threat-intel",
      "category": "soc",
      "purpose": "This module configures threat intelligence gathering and management on a NixOS system.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [
        "socket\""
      ],
      "options_defined": [
        "kernelcore.soc.ids.threatIntel.abuseipdb.apiKeyFile",
        "kernelcore.soc.ids.threatIntel.abuseipdb.confidenceThreshold",
        "kernelcore.soc.ids.threatIntel.misp.url",
        "kernelcore.soc.ids.threatIntel.misp.apiKeyFile",
        "kernelcore.soc.ids.threatIntel.iocTypes",
        "kernelcore.soc.ids.threatIntel.customBlocklists.ips",
        "kernelcore.soc.ids.threatIntel.customBlocklists.domains"
      ],
      "security_concerns": [
        "The script fetches data from various sources without authentication, which could expose the system to potential threats.",
        "Sensitive information like API keys are stored in plain text or SOPS-encrypted files."
      ],
      "recommendations": [
        "Implement proper authentication and encryption for fetching threat intelligence feeds.",
        "Regularly update and review the script for vulnerabilities.",
        "Consider using a more secure method for storing sensitive information like API keys."
      ],
      "lines_of_code": 265,
      "has_documentation": true,
      "analysis_time_ms": 809858,
      "error": null
    },
    {
      "path": "modules/soc/siem/wazuh.nix",
      "name": "wazuh",
      "category": "soc",
      "purpose": "This module configures and deploys a Wazuh SIEM Manager on NixOS using Docker containers.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "config"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "version",
        "agents.enableLocal",
        "agents.autoEnroll",
        "integrations.slack",
        "integrations.virustotal",
        "resources.javaHeapSize"
      ],
      "security_concerns": [
        "The module does not configure SSL/TLS for the Wazuh Manager, which could expose it to man-in-the-middle attacks. The default Java heap size might be insufficient for production environments.",
        "No authentication or authorization is configured for accessing the Wazuh API, which could allow unauthorized access.",
        "The use of Docker containers for Wazuh components might introduce additional security risks if not properly managed."
      ],
      "recommendations": [
        "Configure SSL/TLS for the Wazuh Manager to secure communication. Increase the Java heap size based on your environment's requirements. Implement proper authentication and authorization for accessing the Wazuh API."
      ],
      "lines_of_code": 196,
      "has_documentation": true,
      "analysis_time_ms": 820959,
      "error": null
    },
    {
      "path": "modules/soc/siem/log-aggregator.nix",
      "name": "log-aggregator",
      "category": "soc",
      "purpose": "Configures a centralized log aggregation system using Vector for NixOS",
      "complexity": "medium",
      "dependencies": [
        "pkgs.vector",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.soc.siem.logAggregator.enable",
        "kernelcore.soc.siem.logAggregator.sources",
        "kernelcore.soc.siem.logAggregator.outputs"
      ],
      "security_concerns": [
        "TLS verification is disabled for OpenSearch sink, which may expose sensitive data"
      ],
      "recommendations": [
        "Enable TLS verification for OpenSearch sink",
        "Consider using a more secure log storage solution"
      ],
      "lines_of_code": 284,
      "has_documentation": true,
      "analysis_time_ms": 828430,
      "error": null
    },
    {
      "path": "modules/soc/siem/opensearch.nix",
      "name": "opensearch",
      "category": "soc",
      "purpose": "This module configures and deploys OpenSearch for log storage and analysis on NixOS.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.soc.siem.opensearch.enable",
        "kernelcore.soc.siem.opensearch.clusterName",
        "kernelcore.soc.siem.opensearch.heapSize",
        "kernelcore.soc.siem.opensearch.dataDir",
        "kernelcore.soc.siem.opensearch.indices.securityPrefix",
        "kernelcore.soc.siem.opensearch.indices.retentionDays",
        "kernelcore.soc.siem.opensearch.indices.replicaCount",
        "kernelcore.soc.siem.opensearch.security.enableTLS",
        "kernelcore.soc.siem.opensearch.security.adminPassword"
      ],
      "security_concerns": [
        "OpenSearch is deployed without TLS by default, which can expose sensitive data.",
        "No explicit security checks or configurations are provided for the admin password."
      ],
      "recommendations": [
        "Enable TLS for OpenSearch to secure communication and data in transit.",
        "Configure a strong admin password and store it securely using SOPS or another method.",
        "Review and adjust resource limits (heap size, memory) based on actual needs and available resources."
      ],
      "lines_of_code": 274,
      "has_documentation": true,
      "analysis_time_ms": 842334,
      "error": null
    },
    {
      "path": "modules/soc/alerting/alerting.nix",
      "name": "alerting",
      "category": "soc",
      "purpose": "This module configures an alerting system for a SOC (Security Operations Center) that dispatches alerts to various channels like Slack, Telegram, Discord, and emails.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.curl",
        "pkgs.jq",
        "pkgs.coreutils"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.soc.alerting.enable",
        "kernelcore.soc.alerting.slack.enable",
        "kernelcore.soc.alerting.slack.webhookFile",
        "kernelcore.soc.alerting.slack.channel",
        "kernelcore.soc.alerting.telegram.enable",
        "kernelcore.soc.alerting.telegram.botTokenFile",
        "kernelcore.soc.alerting.telegram.chatId",
        "kernelcore.soc.alerting.discord.enable",
        "kernelcore.soc.alerting.discord.webhookFile",
        "kernelcore.soc.alerting.minSeverity"
      ],
      "security_concerns": [
        "The script reads sensitive information from files without proper validation, which could lead to security risks if the files are not properly secured.",
        "The use of `curl` for sending alerts without proper error handling or logging could mask failures."
      ],
      "recommendations": [
        "Validate and sanitize input data before using it in commands or scripts.",
        "Implement proper logging and error handling for all external commands to ensure better visibility into the system's behavior.",
        "Consider using more secure methods for storing sensitive information, such as environment variables or encrypted files."
      ],
      "lines_of_code": 178,
      "has_documentation": true,
      "analysis_time_ms": 857129,
      "error": null
    },
    {
      "path": "modules/soc/dashboards/grafana.nix",
      "name": "grafana",
      "category": "soc",
      "purpose": "This module configures and enables Grafana with specific dashboards for SOC (Security Operations Center) monitoring.",
      "complexity": "medium",
      "dependencies": [
        "services.grafana",
        "networking.firewall"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "port",
        "domain",
        "adminPassword"
      ],
      "security_concerns": [
        "admin password stored in a file, which could be insecure if not properly managed"
      ],
      "recommendations": [
        "consider using environment variables or secrets management for admin passwords"
      ],
      "lines_of_code": 218,
      "has_documentation": true,
      "analysis_time_ms": 862951,
      "error": null
    },
    {
      "path": "modules/packages/_sources/generated.nix",
      "name": "generated",
      "category": "packages",
      "purpose": "This module defines package sources for various software packages using Nix's fetch functions.",
      "complexity": "low",
      "dependencies": [
        "fetchgit",
        "fetchurl",
        "fetchFromGitHub",
        "dockerTools"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 39,
      "has_documentation": true,
      "analysis_time_ms": 866372,
      "error": null
    },
    {
      "path": "modules/packages/zellij/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Installs Zellij, a terminal workspace with batteries included",
      "complexity": "low",
      "dependencies": [
        "nvfetcher",
        "pkgs.stdenv.mkDerivation"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.zellij.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 55,
      "has_documentation": true,
      "analysis_time_ms": 869673,
      "error": null
    },
    {
      "path": "modules/packages/lynis/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Installs and configures the Lynis security auditing tool",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "config",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.lynis.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 58,
      "has_documentation": true,
      "analysis_time_ms": 872900,
      "error": null
    },
    {
      "path": "modules/packages/protonpass/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Installs Proton Pass, an end-to-end encrypted password manager, as a self-contained package using FHS environment.",
      "complexity": "low",
      "dependencies": [
        "pkgs.binutils",
        "pkgs.gnutar",
        "pkgs.xz"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.protonpass.enable"
      ],
      "security_concerns": [
        "The package is marked as 'unfree' which may indicate potential licensing issues."
      ],
      "recommendations": [
        "Verify the source of the .deb file to ensure it's trustworthy.",
        "Consider using a more standard method for handling Electron apps if possible."
      ],
      "lines_of_code": 91,
      "has_documentation": true,
      "analysis_time_ms": 878892,
      "error": null
    },
    {
      "path": "modules/packages/gemini-cli/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "This module defines a NixOS package for the Google Gemini CLI tool.",
      "complexity": "low",
      "dependencies": [
        "pkgs.buildNpmPackage",
        "pkgs.fetchzip",
        "pkgs.pkg-config",
        "pkgs.python3",
        "pkgs.git",
        "pkgs.libsecret",
        "pkgs.nodejs",
        "pkgs.bash"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.gemini-cli.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 79,
      "has_documentation": true,
      "analysis_time_ms": 884107,
      "error": null
    },
    {
      "path": "modules/packages/_templates/tar-package/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "This module provides a template for creating NixOS packages from tarball sources.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.PACKAGE_NAME.enable"
      ],
      "security_concerns": [],
      "recommendations": [
        "Consider adding checksum validation for URLs",
        "Specify more detailed platforms"
      ],
      "lines_of_code": 74,
      "has_documentation": true,
      "analysis_time_ms": 888082,
      "error": null
    },
    {
      "path": "modules/packages/_templates/deb-package/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "This module provides a template for creating and managing Debian packages in NixOS.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.PACKAGE_NAME.enable"
      ],
      "security_concerns": [
        "The license is set to 'unfree', which may not be appropriate for all packages."
      ],
      "recommendations": [
        "Consider adding more specific dependencies based on the package requirements.",
        "Verify and update the SHA256 hash when using a URL source."
      ],
      "lines_of_code": 103,
      "has_documentation": true,
      "analysis_time_ms": 893486,
      "error": null
    },
    {
      "path": "modules/packages/_templates/npm-package/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "This module defines a template for creating NixOS packages from npm repositories or GitHub.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.PACKAGE_NAME.enable"
      ],
      "security_concerns": [
        "The use of fake hashes for npm dependencies can lead to security vulnerabilities if not properly updated."
      ],
      "recommendations": [
        "Automate the process of updating npm dependency hashes using tools like `nix-prefetch-npm`."
      ],
      "lines_of_code": 72,
      "has_documentation": true,
      "analysis_time_ms": 898524,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/audit.nix",
      "name": "audit",
      "category": "packages",
      "purpose": "This module configures an audited version of a package with logging and monitoring capabilities.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "name",
        "pkg",
        "package"
      ],
      "imports": [],
      "options_defined": [
        "auditWrapper",
        "logRotationService",
        "logRotationTimer",
        "monitoringService"
      ],
      "security_concerns": [
        "The module logs sensitive information which could be a security risk if not properly secured.",
        "Resource monitoring might introduce performance overhead."
      ],
      "recommendations": [
        "Ensure that the log directory and files are properly secured to prevent unauthorized access.",
        "Consider limiting the scope of resource monitoring to avoid unnecessary overhead."
      ],
      "lines_of_code": 275,
      "has_documentation": true,
      "analysis_time_ms": 906500,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Manages .deb packages with sandboxing and audit support",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "../lib/types.nix",
        "./packages/protonpass.nix",
        "./builder.nix"
      ],
      "imports": [
        "../lib/types.nix",
        "./builder.nix"
      ],
      "options_defined": [
        "enable",
        "method",
        "source",
        "sandbox",
        "audit",
        "wrapper",
        "meta"
      ],
      "security_concerns": [
        "No specific security concerns identified in the provided code"
      ],
      "recommendations": [
        "Consider adding more detailed descriptions for each option to improve documentation"
      ],
      "lines_of_code": 110,
      "has_documentation": true,
      "analysis_time_ms": 912058,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/builder.nix",
      "name": "builder",
      "category": "packages",
      "purpose": "Builds .deb packages using shared builders and fetchers",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "packages",
        "storageDir",
        "cacheDir"
      ],
      "imports": [
        "../lib/builders.nix",
        "../lib/fetchers.nix",
        "./audit.nix"
      ],
      "options_defined": [
        "buildDebPackage",
        "fetchDeb",
        "extractDeb"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 62,
      "has_documentation": true,
      "analysis_time_ms": 915821,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/sandbox.nix",
      "name": "sandbox",
      "category": "packages",
      "purpose": "This module configures sandbox profiles for .deb packages on NixOS using bubblewrap and systemd services.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.bubblewrap",
        "../lib/sandbox.nix"
      ],
      "imports": [
        "../lib/sandbox.nix"
      ],
      "options_defined": [
        "kernelcore.packages.deb.sandboxProfiles"
      ],
      "security_concerns": [
        "The module allows unprivileged user namespaces, which could be a security risk if not properly managed.",
        "The use of `DeviceAllow` for `/dev/null` might be too restrictive and could prevent necessary device access."
      ],
      "recommendations": [
        "Review the default sandbox profiles to ensure they meet the security requirements of your environment.",
        "Consider limiting the use of `DeviceAllow` to only those devices that are absolutely necessary for the package to function correctly."
      ],
      "lines_of_code": 134,
      "has_documentation": true,
      "analysis_time_ms": 924215,
      "error": null
    },
    {
      "path": "modules/packages/_archive/lib/fetchers.nix",
      "name": "fetchers",
      "category": "packages",
      "purpose": "Provides unified fetch and extract logic for various package types in NixOS",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "Potential issues with file permissions and extraction processes"
      ],
      "recommendations": [
        "Consider adding more robust error handling for fetch and extract operations"
      ],
      "lines_of_code": 111,
      "has_documentation": true,
      "analysis_time_ms": 928353,
      "error": null
    },
    {
      "path": "modules/packages/_archive/lib/types.nix",
      "name": "types",
      "category": "packages",
      "purpose": "Provides shared type definitions for package modules in NixOS to eliminate duplicate type definitions across different package types.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "url",
        "path",
        "sha256",
        "enable",
        "allowedPaths",
        "blockHardware",
        "resourceLimits",
        "memory",
        "cpu",
        "tasks",
        "name",
        "executable",
        "extraArgs",
        "environmentVariables",
        "enable",
        "logLevel",
        "description",
        "homepage",
        "license",
        "platforms",
        "name",
        "comment",
        "categories",
        "icon"
      ],
      "security_concerns": [
        "The `sha256` field is marked as REQUIRED for security, but it has a default value of an empty string. This could lead to insecure installations if not properly set."
      ],
      "recommendations": [
        "Ensure that the `sha256` field is always provided and validated to prevent insecure package installations.",
        "Consider adding validation for the `allowedPaths`, `blockHardware`, and `resourceLimits` options to ensure they are used securely."
      ],
      "lines_of_code": 226,
      "has_documentation": true,
      "analysis_time_ms": 940343,
      "error": null
    },
    {
      "path": "modules/packages/_archive/lib/sandbox.nix",
      "name": "sandbox",
      "category": "packages",
      "purpose": "This module defines sandbox profiles and functions to generate bubblewrap arguments for various use cases in NixOS.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The `--cap-drop ALL` option drops all capabilities, which might be too restrictive for some applications. The lack of specific capability grants could lead to functionality issues."
      ],
      "recommendations": [
        "Consider allowing specific capabilities instead of dropping all to maintain functionality while improving security."
      ],
      "lines_of_code": 132,
      "has_documentation": true,
      "analysis_time_ms": 945588,
      "error": null
    },
    {
      "path": "modules/packages/_archive/lib/builders.nix",
      "name": "builders",
      "category": "packages",
      "purpose": "Provides functions to build FHS and native package environments in NixOS",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "./sandbox.nix"
      ],
      "imports": [
        "./sandbox.nix",
        "./sandbox.nix"
      ],
      "options_defined": [],
      "security_concerns": [
        "Potential for privilege escalation with bubblewrap sandboxing if not configured correctly"
      ],
      "recommendations": [
        "Consider adding more detailed documentation on how to configure and use the sandbox options"
      ],
      "lines_of_code": 228,
      "has_documentation": true,
      "analysis_time_ms": 951304,
      "error": null
    },
    {
      "path": "modules/packages/_archive/js-packages/build-gemini.nix",
      "name": "build-gemini",
      "category": "packages",
      "purpose": "Builds the npm package 'gemini-cli' version '0.21.0-nightly.20251211.8c83e1ea9'",
      "complexity": "low",
      "dependencies": [
        "nixpkgs"
      ],
      "imports": [
        "<nixpkgs>"
      ],
      "options_defined": [],
      "security_concerns": [
        "npmDepsHash is empty, which may lead to vulnerabilities if not properly managed"
      ],
      "recommendations": [
        "Update npmDepsHash after the first build",
        "Consider using a more secure method for fetching dependencies"
      ],
      "lines_of_code": 31,
      "has_documentation": true,
      "analysis_time_ms": 956501,
      "error": null
    },
    {
      "path": "modules/packages/_archive/js-packages/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Imports other NixOS modules related to JavaScript packages and Gemini CLI.",
      "complexity": "low",
      "dependencies": [
        "./js-packages.nix",
        "./gemini-cli.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 10,
      "has_documentation": false,
      "analysis_time_ms": 959447,
      "error": null
    },
    {
      "path": "modules/packages/_archive/js-packages/builder.nix",
      "name": "builder",
      "category": "packages",
      "purpose": "This module defines a function to build JavaScript packages using NPM and optionally sandbox them.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "../lib/sandbox.nix"
      ],
      "imports": [
        "../lib/sandbox.nix"
      ],
      "options_defined": [],
      "security_concerns": [
        "The use of `bubblewrap` for sandboxing could potentially be a security risk if not properly configured."
      ],
      "recommendations": [
        "Consider adding more detailed documentation on how to configure the sandbox options.",
        "Add validation for the input parameters to ensure they are correctly specified."
      ],
      "lines_of_code": 103,
      "has_documentation": true,
      "analysis_time_ms": 965563,
      "error": null
    },
    {
      "path": "modules/packages/_archive/js-packages/js-packages.nix",
      "name": "js-packages",
      "category": "packages",
      "purpose": "Manages npm packages with sandboxing support in NixOS",
      "complexity": "low",
      "dependencies": [
        "../lib/types.nix",
        "./builder.nix"
      ],
      "imports": [
        "../lib/types.nix",
        "./builder.nix"
      ],
      "options_defined": [
        "enable",
        "packages"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 86,
      "has_documentation": true,
      "analysis_time_ms": 968949,
      "error": null
    },
    {
      "path": "modules/packages/_archive/js-packages/gemini-cli.nix",
      "name": "gemini-cli",
      "category": "packages",
      "purpose": "This module configures and installs the Google Gemini CLI tool on a NixOS system.",
      "complexity": "low",
      "dependencies": [
        "pkgs.callPackage",
        "mkEnableOption",
        "buildNpmPackage"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.packages.gemini-cli.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 82,
      "has_documentation": true,
      "analysis_time_ms": 973032,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/default.nix",
      "name": "default",
      "category": "packages",
      "purpose": "Manages tar.gz packages with sandboxing and audit support",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib",
        "../lib/types.nix"
      ],
      "imports": [
        "../lib/types.nix",
        "./builder.nix"
      ],
      "options_defined": [
        "enable",
        "method",
        "source",
        "wrapper",
        "sandbox",
        "audit",
        "desktopEntry",
        "meta"
      ],
      "security_concerns": [
        "Potential for privilege escalation if sandboxing is not properly configured",
        "Audit logging may not be comprehensive or secure if not properly configured"
      ],
      "recommendations": [
        "Ensure that the `globalSandbox` and `auditByDefault` options are set appropriately based on security requirements",
        "Review and validate all user-provided configurations for `wrapper`, `sandbox`, and `audit` to prevent misconfiguration",
        "Consider implementing more granular control over audit logging to capture only necessary information"
      ],
      "lines_of_code": 151,
      "has_documentation": true,
      "analysis_time_ms": 982415,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/builder.nix",
      "name": "builder",
      "category": "packages",
      "purpose": "Build tar.gz packages using shared builders and fetchers",
      "complexity": "medium",
      "dependencies": [
        "../lib/builders.nix",
        "../lib/fetchers.nix"
      ],
      "imports": [
        "../lib/builders.nix",
        "../lib/fetchers.nix"
      ],
      "options_defined": [],
      "security_concerns": [
        "The module does not appear to have any security-specific features or checks."
      ],
      "recommendations": [
        "Consider adding logging for debugging purposes, as the debug traces are currently disabled in production."
      ],
      "lines_of_code": 94,
      "has_documentation": true,
      "analysis_time_ms": 987022,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/zellij.nix",
      "name": "zellij",
      "category": "packages",
      "purpose": "This module configures the Zellij terminal multiplexer as a tar-package with auto-updates.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "../../_sources/generated.nix"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "method",
        "source",
        "wrapper",
        "sandbox",
        "audit",
        "desktopEntry"
      ],
      "security_concerns": [
        "Sandbox is disabled, which may pose security risks for terminal multiplexers that need broad access to work properly."
      ],
      "recommendations": [
        "Consider enabling the sandbox if possible to mitigate potential security risks."
      ],
      "lines_of_code": 45,
      "has_documentation": true,
      "analysis_time_ms": 992378,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/codex.nix",
      "name": "codex",
      "category": "packages",
      "purpose": "Installs and configures the Codex CLI tool",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "codex.enable",
        "codex.method",
        "codex.source.path",
        "codex.source.sha256",
        "codex.wrapper.executable",
        "codex.wrapper.environmentVariables",
        "codex.sandbox.enable",
        "codex.audit.enable",
        "codex.desktopEntry"
      ],
      "security_concerns": [
        "None identified based on the provided code"
      ],
      "recommendations": [],
      "lines_of_code": 35,
      "has_documentation": true,
      "analysis_time_ms": 997371,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/lynis.nix",
      "name": "lynis",
      "category": "packages",
      "purpose": "Manages the installation and configuration of Lynis, a security auditing tool, outside of nixpkgs for more control.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "_sources/generated.nix"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "method",
        "source.path",
        "source.sha256",
        "wrapper.executable",
        "wrapper.environmentVariables.PATH",
        "sandbox.enable",
        "audit.enable",
        "audit.logLevel"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 62,
      "has_documentation": true,
      "analysis_time_ms": 1002373,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/protonpass.nix",
      "name": "protonpass",
      "category": "packages",
      "purpose": "This module defines a package for Proton Pass, an end-to-end encrypted password manager.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "protonpass.enable",
        "protonpass.method",
        "protonpass.source.url",
        "protonpass.source.sha256",
        "protonpass.wrapper.executable",
        "protonpass.wrapper.environmentVariables.PROTON_PASS_CONFIG_DIR",
        "protonpass.sandbox.enable",
        "protonpass.audit.enable",
        "protonpass.desktopEntry",
        "protonpass.meta.description",
        "protonpass.meta.homepage",
        "protonpass.meta.license",
        "protonpass.meta.maintainers",
        "protonpass.meta.platforms",
        "protonpass.meta.sourceProvenance",
        "protonpass.meta.mainProgram"
      ],
      "security_concerns": [
        "The module does not specify a SHA-256 hash for the source, which could lead to security risks if the file is tampered with.",
        "Sandboxing is disabled, which might expose the application to potential security threats."
      ],
      "recommendations": [
        "Add a SHA-256 hash for the source to ensure the integrity of the downloaded file.",
        "Consider enabling sandboxing to improve security."
      ],
      "lines_of_code": 58,
      "has_documentation": true,
      "analysis_time_ms": 1014443,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/antigravity.nix",
      "name": "antigravity",
      "category": "packages",
      "purpose": "Configures the installation and environment for Google's Antigravity code editor",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "antigravity.enable",
        "antigravity.method",
        "antigravity.source.path",
        "antigravity.source.sha256",
        "antigravity.wrapper.executable",
        "antigravity.wrapper.environmentVariables.ANTIGRAVITY_USER_DATA_DIR",
        "antigravity.sandbox.enable",
        "antigravity.audit.enable",
        "antigravity.desktopEntry.name",
        "antigravity.desktopEntry.comment",
        "antigravity.desktopEntry.categories",
        "antigravity.desktopEntry.icon"
      ],
      "security_concerns": [
        "Sandbox is disabled, which may expose the system to potential security risks if not properly managed"
      ],
      "recommendations": [
        "Consider enabling sandboxing for better isolation and security",
        "Verify the integrity of the source archive using a different method besides SHA256 (e.g., GPG)"
      ],
      "lines_of_code": 48,
      "has_documentation": true,
      "analysis_time_ms": 1024033,
      "error": null
    },
    {
      "path": "modules/packages/_archive/tar-packages/packages/appflowy.nix",
      "name": "appflowy",
      "category": "packages",
      "purpose": "This module configures the installation and setup of AppFlowy, an open-source Notion alternative.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "appflowy.enable",
        "appflowy.method",
        "appflowy.source.path",
        "appflowy.source.sha256",
        "appflowy.wrapper.executable",
        "appflowy.wrapper.environmentVariables.APPFLOWY_DATA_DIR",
        "appflowy.sandbox.enable",
        "appflowy.audit.enable",
        "appflowy.desktopEntry.name",
        "appflowy.desktopEntry.comment",
        "appflowy.desktopEntry.categories",
        "appflowy.desktopEntry.icon"
      ],
      "security_concerns": [
        "Sandbox is disabled, which may expose the application to potential security risks."
      ],
      "recommendations": [
        "Consider enabling the sandbox for better isolation and security.",
        "Add a default icon for the desktop entry."
      ],
      "lines_of_code": 47,
      "has_documentation": true,
      "analysis_time_ms": 1032869,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/packages/protonvpn.nix",
      "name": "protonvpn",
      "category": "packages",
      "purpose": "This module defines configuration for installing and managing the ProtonVPN secure VPN client on NixOS.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "enable",
        "method",
        "source",
        "wrapper",
        "sandbox",
        "audit",
        "meta"
      ],
      "security_concerns": [
        "The module does not specify any security measures beyond enabling audit logging, which may not be sufficient for a critical VPN client."
      ],
      "recommendations": [
        "Consider adding more robust sandboxing and security settings to better protect the system when using ProtonVPN."
      ],
      "lines_of_code": 52,
      "has_documentation": true,
      "analysis_time_ms": 1038257,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/packages/all.nix",
      "name": "all",
      "category": "packages",
      "purpose": "Merges configurations for various .deb packages from the packages/ directory",
      "complexity": "low",
      "dependencies": [
        "./packages/cursor.nix",
        "./packages/protonvpn.nix",
        "./packages/protonpass.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 9,
      "has_documentation": true,
      "analysis_time_ms": 1041711,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/packages/example.nix",
      "name": "example",
      "category": "packages",
      "purpose": "This module defines configurations for various .deb packages with different methods, sources, sandboxing, auditing, and wrapper settings.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "example-tool.enable",
        "example-tool.method",
        "example-tool.source.url",
        "example-tool.source.sha256",
        "example-tool.sandbox.enable",
        "example-tool.sandbox.allowedPaths",
        "example-tool.sandbox.blockHardware",
        "example-tool.sandbox.resourceLimits",
        "example-tool.audit.enable",
        "example-tool.audit.logLevel",
        "example-tool.wrapper.name",
        "example-tool.wrapper.extraArgs",
        "example-tool.wrapper.environmentVariables",
        "example-tool.meta.description",
        "example-tool.meta.homepage",
        "example-tool.meta.license",
        "local-tool.enable",
        "local-tool.method",
        "local-tool.source.path",
        "local-tool.sandbox.enable",
        "local-tool.sandbox.allowedPaths",
        "local-tool.sandbox.blockHardware",
        "local-tool.sandbox.resourceLimits",
        "local-tool.audit.enable",
        "local-tool.audit.logLevel",
        "local-tool.wrapper.name",
        "local-tool.wrapper.extraArgs",
        "local-tool.wrapper.environmentVariables",
        "local-tool.meta.description",
        "local-tool.meta.homepage",
        "local-tool.meta.license",
        "untrusted-app.enable",
        "untrusted-app.method",
        "untrusted-app.source.url",
        "untrusted-app.sandbox.enable",
        "untrusted-app.sandbox.allowedPaths",
        "untrusted-app.sandbox.blockHardware",
        "untrusted-app.sandbox.resourceLimits",
        "untrusted-app.audit.enable",
        "untrusted-app.audit.logLevel",
        "untrusted-app.wrapper.name",
        "untrusted-app.wrapper.extraArgs",
        "untrusted-app.wrapper.environmentVariables",
        "untrusted-app.meta.description",
        "untrusted-app.meta.homepage",
        "untrusted-app.meta.license",
        "dev-tool.enable",
        "dev-tool.method",
        "dev-tool.source.url",
        "dev-tool.sandbox.enable",
        "dev-tool.sandbox.allowedPaths",
        "dev-tool.sandbox.blockHardware",
        "dev-tool.sandbox.resourceLimits",
        "dev-tool.audit.enable",
        "dev-tool.audit.logLevel",
        "dev-tool.wrapper.name",
        "dev-tool.wrapper.extraArgs",
        "dev-tool.wrapper.environmentVariables",
        "dev-tool.meta.description",
        "dev-tool.meta.homepage",
        "dev-tool.meta.license"
      ],
      "security_concerns": [
        "Untrusted applications have maximum isolation, which could be overly restrictive for legitimate use cases.",
        "No default values are provided for some options, which might lead to misconfigurations."
      ],
      "recommendations": [
        "Consider providing default values for all options to avoid misconfigurations.",
        "Review the security implications of setting `allowedPaths` and `blockHardware` to ensure they align with the intended use case.",
        "Add documentation or comments explaining each option's purpose and potential impact."
      ],
      "lines_of_code": 175,
      "has_documentation": true,
      "analysis_time_ms": 1069253,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/packages/protonpass.nix",
      "name": "protonpass",
      "category": "packages",
      "purpose": "Installs and configures Proton Pass, an end-to-end encrypted password manager.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "enable",
        "method",
        "source",
        "wrapper",
        "sandbox",
        "audit",
        "meta"
      ],
      "security_concerns": [
        "The module uses a proprietary license, which may limit the ability to audit and modify the software."
      ],
      "recommendations": [
        "Consider using an open-source password manager for better security transparency."
      ],
      "lines_of_code": 60,
      "has_documentation": true,
      "analysis_time_ms": 1074746,
      "error": null
    },
    {
      "path": "modules/packages/_archive/deb-packages/packages/cursor.nix",
      "name": "cursor",
      "category": "packages",
      "purpose": "Configures the installation and environment for the Cursor AI-Powered Code Editor",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "enable",
        "method",
        "source",
        "wrapper",
        "sandbox",
        "audit"
      ],
      "security_concerns": [
        "Sandbox is disabled, which may pose security risks due to broad filesystem access needed for IDE operations"
      ],
      "recommendations": [
        "Consider enabling sandboxing if possible to mitigate potential security issues"
      ],
      "lines_of_code": 39,
      "has_documentation": true,
      "analysis_time_ms": 1079241,
      "error": null
    },
    {
      "path": "modules/ml/integrations/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Imports and organizes ML integrations modules such as MCP servers and Neovim.",
      "complexity": "low",
      "dependencies": [
        "./mcp",
        "./neovim"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1082024,
      "error": null
    },
    {
      "path": "modules/ml/applications/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Manages ML applications as independent flakes in the projects/ directory",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1084325,
      "error": null
    },
    {
      "path": "modules/ml/services/llama-cpp-swap.nix",
      "name": "llama-cpp-swap",
      "category": "ml",
      "purpose": "This module configures and manages the llama-swap service, which is a model swapping tool for LLaMA C++ Server.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.formats.yaml",
        "lib.mkEnableOption",
        "lib.mkPackageOption",
        "lib.mkOption"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package",
        "port",
        "openFirewall",
        "settings"
      ],
      "security_concerns": [
        "The module does not explicitly address security settings for the service itself, such as securing the configuration file or network access."
      ],
      "recommendations": [
        "Consider adding security hardening options to the systemd service configuration.",
        "Ensure that the configuration file is properly secured and not accessible by unauthorized users."
      ],
      "lines_of_code": 124,
      "has_documentation": true,
      "analysis_time_ms": 1091771,
      "error": null
    },
    {
      "path": "modules/ml/services/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Imports and configures ML inference services like llama.cpp and Ollama",
      "complexity": "low",
      "dependencies": [
        "./llama-cpp.nix",
        "./ollama"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 19,
      "has_documentation": true,
      "analysis_time_ms": 1094784,
      "error": null
    },
    {
      "path": "modules/ml/services/llama-cpp.nix",
      "name": "llama-cpp",
      "category": "ml",
      "purpose": "This module configures and manages the LLaMA C++ server with CUDA support on NixOS.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.llama-cpp",
        "pkgs.cudaPackages"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "package",
        "model",
        "host",
        "port",
        "n_threads",
        "n_gpu_layers",
        "n_parallel",
        "n_ctx",
        "n_batch",
        "extraFlags",
        "openFirewall"
      ],
      "security_concerns": [
        "The module does not explicitly harden the service against privilege escalation or other security risks.",
        "The use of `DynamicUser` is set to false, which might pose a security risk if not properly managed."
      ],
      "recommendations": [
        "Consider adding more specific security settings such as `CapabilityBoundingSet`, `RestrictAddressFamilies`, and others to further harden the service.",
        "Ensure that the user and group permissions are strictly controlled and justified for the service's needs."
      ],
      "lines_of_code": 206,
      "has_documentation": true,
      "analysis_time_ms": 1105711,
      "error": null
    },
    {
      "path": "modules/ml/infrastructure/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Imports and organizes ML infrastructure modules such as storage, VRAM monitoring, and hardware configurations.",
      "complexity": "low",
      "dependencies": [
        "./storage.nix",
        "./vram",
        "./hardware"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 17,
      "has_documentation": true,
      "analysis_time_ms": 1108693,
      "error": null
    },
    {
      "path": "modules/ml/infrastructure/storage.nix",
      "name": "storage",
      "category": "ml",
      "purpose": "This module configures the storage structure and management for machine learning models on a NixOS system.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs",
        "config.kernelcore.ml.models-storage"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ml.models-storage.enable",
        "kernelcore.ml.models-storage.baseDirectory"
      ],
      "security_concerns": [
        "The module sets permissions for directories that may contain sensitive model data, but it does not enforce encryption or access controls beyond file system permissions."
      ],
      "recommendations": [
        "Consider adding more granular access controls and encryption for sensitive model data.",
        "Review the systemd service and timer configurations to ensure they are necessary and do not introduce unnecessary overhead."
      ],
      "lines_of_code": 129,
      "has_documentation": true,
      "analysis_time_ms": 1116161,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/manager.nix",
      "name": "manager",
      "category": "ml",
      "purpose": "Manages ML model offloading via a REST API service",
      "complexity": "medium",
      "dependencies": [
        "pkgs.rustPlatform.buildRustPackage",
        "pkgs.cudatoolkit",
        "pkgs.openssl",
        "pkgs.sqlite",
        "pkgs.linuxPackages.nvidia_x11"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ml.offload.api.enable",
        "kernelcore.ml.offload.api.host",
        "kernelcore.ml.offload.api.port",
        "kernelcore.ml.offload.api.logLevel",
        "kernelcore.ml.offload.api.workers",
        "kernelcore.ml.offload.api.corsEnabled",
        "kernelcore.ml.offload.api.corsOrigins",
        "kernelcore.ml.offload.api.rateLimiting.enable",
        "kernelcore.ml.offload.api.rateLimiting.requestsPerMinute"
      ],
      "security_concerns": [
        "No authentication or authorization checks for API endpoints",
        "Potential for resource exhaustion due to high request rates without proper rate limiting"
      ],
      "recommendations": [
        "Implement authentication and authorization mechanisms",
        "Increase default rate limit values based on expected usage patterns",
        "Consider using a more secure logging mechanism than RUST_LOG"
      ],
      "lines_of_code": 239,
      "has_documentation": true,
      "analysis_time_ms": 1129378,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Configures the ML Offload unified system with multi-backend support and intelligent VRAM management.",
      "complexity": "low",
      "dependencies": [
        "./manager.nix",
        "./registry",
        "./backends"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ml.offload.enable",
        "kernelcore.ml.offload.dataDir",
        "kernelcore.ml.offload.modelsPath"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 71,
      "has_documentation": true,
      "analysis_time_ms": 1133705,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/flake.nix",
      "name": "flake",
      "category": "ml",
      "purpose": "This module sets up a unified ML model orchestration system with VRAM monitoring using both Rust and Python.",
      "complexity": "medium",
      "dependencies": [
        "nixpkgs",
        "rust-overlay",
        "flake-utils"
      ],
      "imports": [
        "rust-overlay)",
        "nixpkgs"
      ],
      "options_defined": [],
      "security_concerns": [
        "The module allows the use of `allowUnfree = true` for CUDA, which may introduce security risks.",
        "No explicit security measures are defined."
      ],
      "recommendations": [
        "Consider removing `allowUnfree = true` if not necessary to avoid potential security issues.",
        "Add security checks and hardening measures where applicable."
      ],
      "lines_of_code": 262,
      "has_documentation": true,
      "analysis_time_ms": 1141580,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/backends/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Aggregates ML backend drivers and provides a standard interface for them.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ml.offload.backends.enable",
        "kernelcore.ml.offload.backends.availableBackends"
      ],
      "security_concerns": [],
      "recommendations": [
        "Uncomment and import the backend drivers as needed.",
        "Consider adding validation for the availableBackends list."
      ],
      "lines_of_code": 51,
      "has_documentation": true,
      "analysis_time_ms": 1145985,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/registry/database.nix",
      "name": "database",
      "category": "ml",
      "purpose": "Manages an ML model registry with auto-discovery and metadata extraction.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.python311",
        "pkgs.writeShellScript"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "autoScanInterval",
        "scanOnBoot",
        "includedPaths",
        "excludedPatterns"
      ],
      "security_concerns": [
        "Potential for privilege escalation if the service is run with elevated privileges"
      ],
      "recommendations": [
        "Consider using a more restrictive user/group for the service to minimize potential damage"
      ],
      "lines_of_code": 167,
      "has_documentation": true,
      "analysis_time_ms": 1152142,
      "error": null
    },
    {
      "path": "modules/ml/orchestration/registry/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "This module sets up a model registry for ML models, including database and discovery components.",
      "complexity": "low",
      "dependencies": [
        "./database.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider adding support for discovery component if it exists in manager.nix"
      ],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1155326,
      "error": null
    },
    {
      "path": "modules/ml/infrastructure/hardware/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Provides a base configuration for hardware settings related to machine learning, specifically focusing on CUDA and GPU configurations.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider importing the `./cuda.nix` module if it contains necessary configurations."
      ],
      "lines_of_code": 15,
      "has_documentation": true,
      "analysis_time_ms": 1158505,
      "error": null
    },
    {
      "path": "modules/ml/infrastructure/vram/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Manages GPU VRAM allocation through monitoring and scheduling",
      "complexity": "low",
      "dependencies": [
        "./monitoring.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider implementing a central GPU scheduler as indicated by the TODO comment"
      ],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1161452,
      "error": null
    },
    {
      "path": "modules/ml/infrastructure/vram/monitoring.nix",
      "name": "monitoring",
      "category": "ml",
      "purpose": "Manages VRAM usage for GPU-intensive machine learning applications with monitoring, scheduling, and alerting.",
      "complexity": "medium",
      "dependencies": [
        "nvidia-smi",
        "python311Packages.nvidia-ml-py",
        "requests"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "monitoringInterval",
        "autoScaling.enable",
        "autoScaling.threshold",
        "autoScaling.evictionPolicy",
        "budgetPlanner.enable",
        "budgetPlanner.safetyMargin",
        "alerts.enable",
        "alerts.highUsageThreshold",
        "alerts.notificationMethod",
        "alerts.webhookUrl",
        "scheduler.enable",
        "scheduler.maxQueueSize",
        "scheduler.timeoutSeconds"
      ],
      "security_concerns": [
        "Running services as non-root user (ml-offload)",
        "Access to NVIDIA device files for monitoring",
        "Potential for privilege escalation if not properly managed"
      ],
      "recommendations": [
        "Ensure proper SELinux or AppArmor policies are in place for the ml-offload user and service",
        "Regularly update dependencies to mitigate known vulnerabilities",
        "Implement more granular access controls for NVIDIA device files"
      ],
      "lines_of_code": 241,
      "has_documentation": true,
      "analysis_time_ms": 1173972,
      "error": null
    },
    {
      "path": "modules/ml/services/ollama/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Imports and configures the Ollama inference service with GPU memory management.",
      "complexity": "low",
      "dependencies": [
        "./gpu-manager.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider adding a TODO comment to extract `service.nix` from `configuration.nix` if it exists."
      ],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1177451,
      "error": null
    },
    {
      "path": "modules/ml/services/ollama/gpu-manager.nix",
      "name": "gpu-manager",
      "category": "ml",
      "purpose": "Manages Ollama GPU models by automatically unloading them when inactive or on shell exit.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.curl",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "unloadOnShellExit",
        "idleTimeout",
        "monitoringInterval"
      ],
      "security_concerns": [
        "Potential for privilege escalation if the service runs as 'nobody'",
        "Untrusted input handling in shell aliases"
      ],
      "recommendations": [
        "Consider running the service with a more restricted user account",
        "Validate and sanitize inputs to shell aliases"
      ],
      "lines_of_code": 132,
      "has_documentation": true,
      "analysis_time_ms": 1184063,
      "error": null
    },
    {
      "path": "modules/ml/integrations/mcp/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Imports configuration for the Model Context Protocol (MCP) server integration in NixOS.",
      "complexity": "low",
      "dependencies": [
        "./config.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 16,
      "has_documentation": true,
      "analysis_time_ms": 1186732,
      "error": null
    },
    {
      "path": "modules/ml/integrations/mcp/config.nix",
      "name": "config",
      "category": "ml",
      "purpose": "Configures MCP (Model Context Protocol) for NixOS systems, including setting up knowledge databases and agent configurations.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.jq",
        "securellm-mcp"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.ml.mcp.enable",
        "kernelcore.ml.mcp.mcpPackage",
        "kernelcore.ml.mcp.knowledgeDbPath",
        "kernelcore.ml.mcp.agents"
      ],
      "security_concerns": [
        "The module creates a shared group 'mcp-shared' which users must manually add to. This could potentially lead to security risks if not managed properly."
      ],
      "recommendations": [
        "Consider adding documentation on how to manage the 'mcp-shared' group for better security practices."
      ],
      "lines_of_code": 139,
      "has_documentation": true,
      "analysis_time_ms": 1194452,
      "error": null
    },
    {
      "path": "modules/ml/integrations/neovim/default.nix",
      "name": "default",
      "category": "ml",
      "purpose": "Provides ML features for Neovim integration",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Add imports from offload/neovim/ if needed"
      ],
      "lines_of_code": 15,
      "has_documentation": true,
      "analysis_time_ms": 1197036,
      "error": null
    },
    {
      "path": "modules/desktop/yazi/yazi.nix",
      "name": "yazi",
      "category": "desktop",
      "purpose": "Installs the Yazi text editor on the system level.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 18,
      "has_documentation": true,
      "analysis_time_ms": 1199329,
      "error": null
    },
    {
      "path": "modules/services/users/gemini-agent.nix",
      "name": "gemini-agent",
      "category": "services",
      "purpose": "Manages the configuration for a Gemini Agent user service on NixOS",
      "complexity": "low",
      "dependencies": [
        "kernelcore.packages.gemini-cli"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "userName",
        "homeDirectory",
        "allowedGroups",
        "sudoNoPasswd"
      ],
      "security_concerns": [
        "passwordless sudo for system operations could pose a security risk"
      ],
      "recommendations": [
        "consider limiting the sudo permissions to only necessary commands"
      ],
      "lines_of_code": 101,
      "has_documentation": true,
      "analysis_time_ms": 1204284,
      "error": null
    },
    {
      "path": "modules/services/users/actions.nix",
      "name": "actions",
      "category": "services",
      "purpose": "Configures a GitHub Actions self-hosted runner on NixOS",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib",
        "config"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "useSops",
        "runnerType",
        "runnerName",
        "repoUrl",
        "extraLabels",
        "rotateRunner",
        "ephemeral"
      ],
      "security_concerns": [
        "Use of SOPS for secret management, but token file path is hardcoded"
      ],
      "recommendations": [
        "Consider using a more dynamic approach to the token file path"
      ],
      "lines_of_code": 163,
      "has_documentation": true,
      "analysis_time_ms": 1210262,
      "error": null
    },
    {
      "path": "modules/services/users/claude-code.nix",
      "name": "claude-code",
      "category": "services",
      "purpose": "Configures a dedicated user for Claude Code with specific permissions and packages.",
      "complexity": "low",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "userName",
        "homeDirectory",
        "allowedGroups",
        "sudoNoPasswd",
        "nixTrusted"
      ],
      "security_concerns": [
        "passwordless sudo for system operations, which could be risky if not properly managed"
      ],
      "recommendations": [
        "consider limiting the list of allowed groups to only those necessary for Claude Code's operations"
      ],
      "lines_of_code": 146,
      "has_documentation": true,
      "analysis_time_ms": 1216081,
      "error": null
    },
    {
      "path": "modules/services/users/gitlab-runner.nix",
      "name": "gitlab-runner",
      "category": "services",
      "purpose": "This module configures and manages a GitLab Runner service on NixOS.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib",
        "config"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "useSops",
        "registrationToken",
        "url",
        "runnerName",
        "executor",
        "tags",
        "concurrent",
        "dockerImage"
      ],
      "security_concerns": [
        "If SOPS is not used, the registration token could be exposed in plain text.",
        "The use of root privileges for Docker executor might pose a security risk."
      ],
      "recommendations": [
        "Consider using SOPS for secret management to avoid exposing sensitive information.",
        "Review and adjust permissions for the gitlab-runner user and group."
      ],
      "lines_of_code": 159,
      "has_documentation": true,
      "analysis_time_ms": 1223365,
      "error": null
    },
    {
      "path": "modules/services/users/default.nix",
      "name": "default",
      "category": "services",
      "purpose": "Centralizes the management of service users across the system with consistent permissions and security policies.",
      "complexity": "low",
      "dependencies": [
        "./actions.nix",
        "./claude-code.nix",
        "./codex-agent.nix",
        "./gemini-agent.nix",
        "./gitlab-runner.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 20,
      "has_documentation": true,
      "analysis_time_ms": 1227413,
      "error": null
    },
    {
      "path": "modules/services/users/codex-agent.nix",
      "name": "codex-agent",
      "category": "services",
      "purpose": "Manages the Codex agent user and systemd service in NixOS",
      "complexity": "medium",
      "dependencies": [
        "pkgs.codex",
        "pkgs.nodejs_22"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "userName",
        "homeDirectory",
        "workDirectory",
        "configFile",
        "environmentFile",
        "package",
        "binaryName",
        "extraEnvironment",
        "execCommand",
        "wantedBy"
      ],
      "security_concerns": [
        "The service runs as a system user without additional privileges, which is generally safe but should be reviewed in the context of the overall security posture.",
        "The use of `exec` to run commands based on command-line arguments can lead to injection vulnerabilities if not properly sanitized."
      ],
      "recommendations": [
        "Consider adding more detailed logging and error handling in the service script for better troubleshooting.",
        "Review the default permissions set for directories (e.g., `0750`) to ensure they align with security requirements.",
        "Ensure that the `extraEnvironment` is properly sanitized to avoid injection attacks."
      ],
      "lines_of_code": 191,
      "has_documentation": true,
      "analysis_time_ms": 1239042,
      "error": null
    },
    {
      "path": "modules/network/monitoring/tailscale-monitor.nix",
      "name": "tailscale-monitor",
      "category": "network",
      "purpose": "This module sets up a monitoring script for Tailscale connectivity and quality, with auto-failover capabilities.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.tailscale",
        "pkgs.netcat",
        "pkgs.mailutils",
        "pkgs.bc"
      ],
      "imports": [],
      "options_defined": [
        "CHECK_INTERVAL",
        "MAX_LATENCY",
        "MAX_PACKET_LOSS",
        "ALERT_EMAIL",
        "LOGS_DIRECTORY"
      ],
      "security_concerns": [
        "The script uses `sudo` to run Tailscale commands, which could be a security risk if not properly managed."
      ],
      "recommendations": [
        "Consider using a non-root user for running the monitoring script.",
        "Implement proper logging and alerting mechanisms to ensure timely intervention in case of issues."
      ],
      "lines_of_code": 450,
      "has_documentation": true,
      "analysis_time_ms": 1249155,
      "error": null
    },
    {
      "path": "modules/network/security/firewall-zones.nix",
      "name": "firewall-zones",
      "category": "network",
      "purpose": "This module configures firewall zones using nftables for network security in NixOS.",
      "complexity": "medium",
      "dependencies": [
        "lib",
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.network.security.firewall-zones.enable",
        "kernelcore.network.security.firewall-zones.zones.dmz.enable",
        "kernelcore.network.security.firewall-zones.zones.dmz.interfaces",
        "kernelcore.network.security.firewall-zones.zones.dmz.allowedTCPPorts",
        "kernelcore.network.security.firewall-zones.zones.dmz.allowedUDPPorts",
        "kernelcore.network.security.firewall-zones.zones.internal.enable",
        "kernelcore.network.security.firewall-zones.zones.internal.interfaces",
        "kernelcore.network.security.firewall-zones.zones.internal.allowedServices",
        "kernelcore.network.security.firewall-zones.zones.admin.enable",
        "kernelcore.network.security.firewall-zones.zones.admin.allowedIPs",
        "kernelcore.network.security.firewall-zones.zones.admin.allowAllServices",
        "kernelcore.network.security.firewall-zones.zones.isolated.enable",
        "kernelcore.network.security.firewall-zones.zones.isolated.interfaces",
        "kernelcore.network.security.firewall-zones.zones.isolated.denyInterzone",
        "kernelcore.network.security.firewall-zones.defaultPolicy",
        "kernelcore.network.security.firewall-zones.enableLogging",
        "kernelcore.network.security.firewall-zones.logPrefix",
        "kernelcore.network.security.firewall-zones.enableRateLimiting",
        "kernelcore.network.security.firewall-zones.rateLimitBurst"
      ],
      "security_concerns": [
        "The default policy is set to 'drop', which may block legitimate traffic if not configured properly.",
        "No explicit validation or sanitization of user-provided IP addresses, ports, and service names."
      ],
      "recommendations": [
        "Consider setting a more permissive default policy for testing purposes, then tighten it based on security requirements.",
        "Implement input validation and sanitization for all configurable options to prevent injection attacks.",
        "Document the expected format and values for each option to ensure proper configuration."
      ],
      "lines_of_code": 365,
      "has_documentation": true,
      "analysis_time_ms": 1269945,
      "error": null
    },
    {
      "path": "modules/network/proxy/tailscale-services.nix",
      "name": "tailscale-services",
      "category": "network",
      "purpose": "Configures Tailscale and NGINX for service exposure in a NixOS environment",
      "complexity": "medium",
      "dependencies": [
        "kernelcore.network.vpn.tailscale",
        "kernelcore.network.proxy.nginx-tailscale",
        "kernelcore.secrets.tailscale"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "tailnetDomain"
      ],
      "security_concerns": [
        "use of SOPS-encrypted auth key if available",
        "explicitly enable services like PostgreSQL and Docker API with authentication",
        "allowing specific IP ranges for Docker API access"
      ],
      "recommendations": [
        "consider using more secure methods for storing sensitive information like auth keys",
        "review and tighten firewall rules for each service",
        "ensure that all exposed services are properly secured"
      ],
      "lines_of_code": 134,
      "has_documentation": true,
      "analysis_time_ms": 1277612,
      "error": null
    },
    {
      "path": "modules/network/proxy/default.nix",
      "name": "default",
      "category": "network",
      "purpose": "Aggregates network proxy-related NixOS modules",
      "complexity": "low",
      "dependencies": [
        "./nginx-tailscale.nix",
        "./tailscale-services.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 8,
      "has_documentation": true,
      "analysis_time_ms": 1280536,
      "error": null
    },
    {
      "path": "modules/network/proxy/nginx-tailscale.nix",
      "name": "nginx-tailscale",
      "category": "network",
      "purpose": "Configures an NGINX reverse proxy for Tailscale services with options to enable various features like SSL/TLS, authentication, rate limiting, and WebSocket support.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.nginx",
        "pkgs.nginxQuic"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "subdomain",
        "upstreamHost",
        "upstreamPort",
        "protocol",
        "enableSSL",
        "enableAuth",
        "authFile",
        "rateLimit",
        "maxBodySize",
        "timeout",
        "enableWebSocket",
        "extraConfig"
      ],
      "security_concerns": [
        "EnableSSL is set to false, which may expose services to unencrypted traffic.",
        "No explicit SSL/TLS configuration for NGINX, relying on Tailscale's HTTPS."
      ],
      "recommendations": [
        "Set enableSSL to true if SSL/TLS termination is required at the proxy level.",
        "Configure recommendedTlsSettings in NGINX for secure TLS/SSL configurations.",
        "Review and update security headers based on current best practices."
      ],
      "lines_of_code": 321,
      "has_documentation": true,
      "analysis_time_ms": 1292573,
      "error": null
    },
    {
      "path": "modules/network/dns/default.nix",
      "name": "default",
      "category": "network",
      "purpose": "This module configures and installs a DNS proxy with caching for improved resolution on NixOS systems.",
      "complexity": "low",
      "dependencies": [
        "pkgs.buildGoModule",
        "pkgs.writeText"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "listenAddress",
        "upstreams",
        "cacheSize",
        "cacheTTL",
        "timeout",
        "enableStats",
        "setAsSystemResolver"
      ],
      "security_concerns": [
        "DynamicUser and NoNewPrivileges are set, but other security hardening measures like AppArmor or SELinux could be considered for additional protection."
      ],
      "recommendations": [
        "Consider adding support for configuring DNSSEC validation if required.",
        "Review the upstream DNS servers to ensure they are secure and trustworthy."
      ],
      "lines_of_code": 147,
      "has_documentation": true,
      "analysis_time_ms": 1300112,
      "error": null
    },
    {
      "path": "modules/network/vpn/tailscale-desktop.nix",
      "name": "tailscale-desktop",
      "category": "network",
      "purpose": "Configures Tailscale for a desktop machine to act as a subnet router in a home network.",
      "complexity": "low",
      "dependencies": [
        "./tailscale.nix"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.network.vpn.tailscale.enable",
        "kernelcore.network.vpn.tailscale.hostname",
        "kernelcore.network.vpn.tailscale.enableSubnetRouter",
        "kernelcore.network.vpn.tailscale.advertiseRoutes",
        "kernelcore.network.vpn.tailscale.acceptRoutes",
        "kernelcore.network.vpn.tailscale.acceptDNS",
        "kernelcore.network.vpn.tailscale.enableMagicDNS",
        "kernelcore.network.vpn.tailscale.enableSSH",
        "kernelcore.network.vpn.tailscale.shieldsUp",
        "kernelcore.network.vpn.tailscale.enableConnectionPersistence",
        "kernelcore.network.vpn.tailscale.reconnectTimeout",
        "kernelcore.network.vpn.tailscale.openFirewall",
        "kernelcore.network.vpn.tailscale.trustedInterface",
        "kernelcore.network.vpn.tailscale.autoStart",
        "kernelcore.network.vpn.tailscale.tags",
        "kernelcore.network.vpn.tailscale.extraUpFlags"
      ],
      "security_concerns": [
        "shieldsUp is set to false, allowing connections from other devices."
      ],
      "recommendations": [
        "Consider setting shieldsUp to true for enhanced security.",
        "Review and adjust advertiseRoutes according to your network's subnet configuration."
      ],
      "lines_of_code": 170,
      "has_documentation": true,
      "analysis_time_ms": 1315300,
      "error": null
    },
    {
      "path": "modules/network/vpn/tailscale-laptop.nix",
      "name": "tailscale-laptop",
      "category": "network",
      "purpose": "Configures Tailscale for a mobile development workstation on a laptop",
      "complexity": "low",
      "dependencies": [
        "./tailscale.nix",
        "pkgs.tailscale"
      ],
      "imports": [],
      "options_defined": [
        "enableSubnetRouter",
        "advertiseRoutes",
        "acceptRoutes",
        "acceptDNS",
        "enableMagicDNS",
        "enableSSH",
        "shieldsUp",
        "enableConnectionPersistence",
        "reconnectTimeout",
        "openFirewall",
        "trustedInterface",
        "autoStart",
        "tags",
        "extraUpFlags"
      ],
      "security_concerns": [
        "shieldsUp is set to false, allowing connections from other devices"
      ],
      "recommendations": [
        "Consider setting shieldsUp to true for enhanced security"
      ],
      "lines_of_code": 97,
      "has_documentation": true,
      "analysis_time_ms": 1322199,
      "error": null
    },
    {
      "path": "modules/network/vpn/tailscale.nix",
      "name": "tailscale",
      "category": "network",
      "purpose": "Configures Tailscale VPN on NixOS with various options for authentication, network settings, and security.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.tailscale",
        "pkgs.curl",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "authKeyFile",
        "useAuthKeyFile",
        "hostname",
        "advertiseRoutes",
        "enableSubnetRouter",
        "exitNode",
        "exitNodeAllowLANAccess",
        "acceptDNS",
        "enableMagicDNS",
        "extraDNSServers",
        "acceptRoutes",
        "enableSSH",
        "shieldsUp",
        "port",
        "interfaceName",
        "enableConnectionPersistence",
        "reconnectTimeout",
        "openFirewall",
        "trustedInterface",
        "tags",
        "extraUpFlags",
        "extraDaemonFlags",
        "autoStart",
        "stateDir"
      ],
      "security_concerns": [
        "Authentication via SOPS-encrypted file, which could be a security risk if not properly managed.",
        "Defaulting to accepting routes and DNS from other devices without additional checks."
      ],
      "recommendations": [
        "Ensure the authKeyFile is securely stored and rotated regularly.",
        "Consider implementing more granular access control for Tailscale devices using tags.",
        "Review and adjust firewall rules based on specific network requirements."
      ],
      "lines_of_code": 447,
      "has_documentation": true,
      "analysis_time_ms": 1336797,
      "error": null
    },
    {
      "path": "modules/network/vpn/nordvpn.nix",
      "name": "nordvpn",
      "category": "network",
      "purpose": "Manages NordVPN configuration and integration with NixOS",
      "complexity": "medium",
      "dependencies": [
        "pkgs.wireguard-tools",
        "pkgs.openresolv",
        "pkgs.curl",
        "pkgs.jq"
      ],
      "imports": [],
      "options_defined": [
        "enable",
        "credentialsFile",
        "autoConnect",
        "preferredCountry",
        "protocol",
        "overrideDNS"
      ],
      "security_concerns": [
        "Credentials file is stored in plaintext by default, which may conflict with SOPS encryption",
        "No explicit validation of server public key or endpoint",
        "Firewall rules rely on wg-quick status, which could be bypassed if wg-quick is not running"
      ],
      "recommendations": [
        "Ensure credentials file is encrypted using SOPS",
        "Validate server public key and endpoint before use",
        "Consider using a more robust kill switch mechanism that does not rely solely on wg-quick status"
      ],
      "lines_of_code": 309,
      "has_documentation": true,
      "analysis_time_ms": 1348138,
      "error": null
    },
    {
      "path": "modules/hardware/laptop-defense/mcp-integration.nix",
      "name": "mcp-integration",
      "category": "hardware",
      "purpose": "Adds thermal forensics and safety check tools to an MCP server for laptop defense.",
      "complexity": "low",
      "dependencies": [
        "pkgs.bash",
        "pkgs.lm_sensors",
        "pkgs.writeShellScriptBin"
      ],
      "imports": [],
      "options_defined": [
        "services.mcp.laptopDefense.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 186,
      "has_documentation": true,
      "analysis_time_ms": 1353213,
      "error": null
    },
    {
      "path": "modules/hardware/laptop-defense/flake.nix",
      "name": "flake",
      "category": "hardware",
      "purpose": "This module provides a framework for collecting thermal forensic data on a laptop, including baseline measurements, stress testing, rebuild simulation, analysis, and hardware diagnostics.",
      "complexity": "medium",
      "dependencies": [
        "nixpkgs"
      ],
      "imports": [
        "json",
        "csv",
        "statistics",
        "defaultdict"
      ],
      "options_defined": [],
      "security_concerns": [
        "The script collects sensitive system information which could be used for malicious purposes if accessed by unauthorized users."
      ],
      "recommendations": [
        "Consider adding options to configure the output directory and report format. Implement more robust error handling and logging. Ensure that the script is run with appropriate permissions."
      ],
      "lines_of_code": 760,
      "has_documentation": true,
      "analysis_time_ms": 1360261,
      "error": null
    },
    {
      "path": "modules/hardware/laptop-defense/rebuild-hooks.nix",
      "name": "rebuild-hooks",
      "category": "hardware",
      "purpose": "This module integrates thermal safety checks and evidence collection into NixOS rebuilds to prevent hardware damage due to overheating.",
      "complexity": "medium",
      "dependencies": [
        "pkgs.lm_sensors",
        "pkgs.bash"
      ],
      "imports": [],
      "options_defined": [
        "hardware.rebuildHooks.enable",
        "hardware.rebuildHooks.thermalCheck.enable",
        "hardware.rebuildHooks.thermalCheck.maxStartTemp",
        "hardware.rebuildHooks.thermalCheck.maxRunningTemp",
        "hardware.rebuildHooks.thermalCheck.monitorInterval",
        "hardware.rebuildHooks.evidenceCollection.enable",
        "hardware.rebuildHooks.evidenceCollection.storePath"
      ],
      "security_concerns": [
        "The module allows bypassing thermal checks, which could lead to hardware damage if not properly managed."
      ],
      "recommendations": [
        "Consider implementing stricter default values for `maxStartTemp` and `maxRunningTemp`.",
        "Ensure that the evidence collection script is secure and does not expose sensitive information.",
        "Provide clear documentation on how to safely bypass thermal checks and the potential risks involved."
      ],
      "lines_of_code": 321,
      "has_documentation": true,
      "analysis_time_ms": 1372296,
      "error": null
    },
    {
      "path": "modules/hardware/i915-governor/default.nix",
      "name": "default",
      "category": "hardware",
      "purpose": "Provides configuration options for the Intel i915 Memory Governor service",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "enable",
        "thresholds.gpuCritical",
        "thresholds.memoryPressure"
      ],
      "security_concerns": [],
      "recommendations": [
        "Re-enable when package available via flake input"
      ],
      "lines_of_code": 36,
      "has_documentation": true,
      "analysis_time_ms": 1375745,
      "error": null
    },
    {
      "path": "modules/shell/aliases/macos-kvm.nix",
      "name": "macos-kvm",
      "category": "shell",
      "purpose": "Provides shell aliases for managing macOS VMs using KVM on NixOS",
      "complexity": "low",
      "dependencies": [
        "kernelcore.macos-kvm.enable"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 94,
      "has_documentation": true,
      "analysis_time_ms": 1379627,
      "error": null
    },
    {
      "path": "modules/shell/aliases/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Aggregates and imports various shell alias modules for different categories such as Docker, Kubernetes, AI/ML, Nix/NixOS, system utilities, and more.",
      "complexity": "low",
      "dependencies": [
        "./docker",
        "./kubernetes",
        "./gcloud",
        "./ai",
        "./nix",
        "./system",
        "./security",
        "./desktop",
        "./amazon",
        "./mcp.nix",
        "./emergency.nix",
        "./laptop-defense.nix",
        "./macos-kvm.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider enabling the temporarily disabled modules if they are needed for completeness."
      ],
      "lines_of_code": 43,
      "has_documentation": true,
      "analysis_time_ms": 1386361,
      "error": null
    },
    {
      "path": "modules/shell/aliases/service-control.nix",
      "name": "service-control",
      "category": "shell",
      "purpose": "Provides aliases for controlling various services and processes related to GPU/ML optimization, including Nix daemon, Ollama, Llama.cpp, ML offload, Docker, and ClamAV.",
      "complexity": "low",
      "dependencies": [
        "pkgs"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.shell.serviceControl.enable"
      ],
      "security_concerns": [
        "sudo usage for stopping/restarting services",
        "pkill with -9 for force killing processes"
      ],
      "recommendations": [
        "consider using non-root users for service management if possible",
        "review and tighten security around sudo usage"
      ],
      "lines_of_code": 537,
      "has_documentation": true,
      "analysis_time_ms": 1393884,
      "error": null
    },
    {
      "path": "modules/shell/aliases/laptop-defense.nix",
      "name": "laptop-defense",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for thermal forensics, hardware protection, and system monitoring on laptops.",
      "complexity": "low",
      "dependencies": [
        "nixpkgs",
        "thermal-profile"
      ],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 213,
      "has_documentation": true,
      "analysis_time_ms": 1399242,
      "error": null
    },
    {
      "path": "modules/shell/aliases/sync.nix",
      "name": "sync",
      "category": "shell",
      "purpose": "Defines shell aliases for synchronizing files between a laptop and desktop using rsync.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [
        "The use of `--no-delete` in some commands could lead to data loss if not used carefully."
      ],
      "recommendations": [
        "Consider adding a warning or confirmation step before running bidirectional sync commands like 'sync-both-nixos'."
      ],
      "lines_of_code": 38,
      "has_documentation": true,
      "analysis_time_ms": 1403951,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nixos-explorer.nix",
      "name": "nixos-explorer",
      "category": "shell",
      "purpose": "Provides a shell script for exploring NixOS configuration options and system state.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "kernelcore.shell.nixosExplorer.enable"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 236,
      "has_documentation": true,
      "analysis_time_ms": 1409134,
      "error": null
    },
    {
      "path": "modules/shell/aliases/mcp.nix",
      "name": "mcp",
      "category": "shell",
      "purpose": "This module defines shell aliases for interacting with the MCP (Model Context Protocol) Knowledge System.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases",
        "environment.interactiveShellInit"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 122,
      "has_documentation": true,
      "analysis_time_ms": 1413162,
      "error": null
    },
    {
      "path": "modules/shell/aliases/emergency.nix",
      "name": "emergency",
      "category": "shell",
      "purpose": "Provides emergency response aliases for NixOS systems.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases",
        "environment.interactiveShellInit"
      ],
      "security_concerns": [
        "Commands like 'kill-nix-builds' and 'kill-compilers' use 'sudo', which can be risky if not properly managed.",
        "The 'emergency-recover' combo runs multiple commands with elevated privileges, potentially leading to unintended consequences."
      ],
      "recommendations": [
        "Consider adding more detailed documentation for each alias.",
        "Review the security implications of running these commands and ensure they are only accessible by authorized users.",
        "Implement safeguards or checks within the aliases to prevent accidental misuse."
      ],
      "lines_of_code": 154,
      "has_documentation": true,
      "analysis_time_ms": 1421365,
      "error": null
    },
    {
      "path": "modules/shell/aliases/kubernetes/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports a Nix module for Kubernetes aliases.",
      "complexity": "low",
      "dependencies": [
        "./kubectl.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1423634,
      "error": null
    },
    {
      "path": "modules/shell/aliases/kubernetes/kubectl.nix",
      "name": "kubectl",
      "category": "shell",
      "purpose": "Defines shell aliases for kubectl commands to simplify Kubernetes management in the NixOS environment.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 50,
      "has_documentation": true,
      "analysis_time_ms": 1426551,
      "error": null
    },
    {
      "path": "modules/shell/aliases/system/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports utility and navigation modules for shell aliases.",
      "complexity": "low",
      "dependencies": [
        "./utils.nix",
        "./navigation.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 7,
      "has_documentation": true,
      "analysis_time_ms": 1429026,
      "error": null
    },
    {
      "path": "modules/shell/aliases/system/navigation.nix",
      "name": "navigation",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for enhanced file navigation and listing using eza and tree commands with custom ignore patterns.",
      "complexity": "low",
      "dependencies": [
        "eza",
        "tree"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 223,
      "has_documentation": true,
      "analysis_time_ms": 1434623,
      "error": null
    },
    {
      "path": "modules/shell/aliases/system/utils.nix",
      "name": "utils",
      "category": "shell",
      "purpose": "Defines shell aliases for system utilities and common tasks.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [
        "None identified in the provided code snippet."
      ],
      "recommendations": [],
      "lines_of_code": 52,
      "has_documentation": true,
      "analysis_time_ms": 1437589,
      "error": null
    },
    {
      "path": "modules/shell/aliases/docker/compose.nix",
      "name": "compose",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for managing Docker Compose operations.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 88,
      "has_documentation": true,
      "analysis_time_ms": 1440532,
      "error": null
    },
    {
      "path": "modules/shell/aliases/docker/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports and aggregates Docker-related alias modules for the shell environment.",
      "complexity": "low",
      "dependencies": [
        "./build.nix",
        "./run.nix",
        "./compose.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 15,
      "has_documentation": true,
      "analysis_time_ms": 1443551,
      "error": null
    },
    {
      "path": "modules/shell/aliases/docker/run.nix",
      "name": "run",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for Docker commands with various configurations and options.",
      "complexity": "low",
      "dependencies": [
        "config",
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The use of `--rm` in many aliases could lead to data loss if not used carefully. The `docker exec` commands lack specific container name or ID, which could be a security risk if the shell is accessible to untrusted users."
      ],
      "recommendations": [
        "Consider adding more descriptive names for aliases that might conflict with existing ones. Add options to specify Docker images and command arguments dynamically. Implement checks to ensure only authorized users can execute certain commands."
      ],
      "lines_of_code": 120,
      "has_documentation": true,
      "analysis_time_ms": 1450780,
      "error": null
    },
    {
      "path": "modules/shell/aliases/docker/build.nix",
      "name": "build",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for Docker build commands with various options and configurations.",
      "complexity": "low",
      "dependencies": [
        "config",
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The use of `--secret` without specifying the secret value directly in the alias could expose sensitive information if not handled properly."
      ],
      "recommendations": [
        "Consider adding a way to securely pass secrets, such as using environment variables or secure vaults."
      ],
      "lines_of_code": 149,
      "has_documentation": true,
      "analysis_time_ms": 1456444,
      "error": null
    },
    {
      "path": "modules/shell/aliases/desktop/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports the `hyprland.nix` module to include Hyprland-specific aliases in the shell environment.",
      "complexity": "low",
      "dependencies": [
        "./hyprland.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1459302,
      "error": null
    },
    {
      "path": "modules/shell/aliases/desktop/hyprland.nix",
      "name": "hyprland",
      "category": "shell",
      "purpose": "Defines shell aliases for managing Hyprland and Waybar configurations in a NixOS environment.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 30,
      "has_documentation": true,
      "analysis_time_ms": 1462137,
      "error": null
    },
    {
      "path": "modules/shell/aliases/security/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports the `secrets.nix` module to include security-related aliases in the shell environment.",
      "complexity": "low",
      "dependencies": [
        "./secrets.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1464838,
      "error": null
    },
    {
      "path": "modules/shell/aliases/security/secrets.nix",
      "name": "secrets",
      "category": "shell",
      "purpose": "Provides shell aliases for managing secrets using SOPS and AGE encryption.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The module does not enforce secure key management practices, such as rotating keys regularly.",
        "It includes a command to check for plaintext secrets in the repository, which is dangerous and should be avoided."
      ],
      "recommendations": [
        "Implement regular key rotation for AGE keys.",
        "Remove or disable the `secrets-check-plaintext` command to prevent accidental exposure of sensitive information."
      ],
      "lines_of_code": 178,
      "has_documentation": true,
      "analysis_time_ms": 1472344,
      "error": null
    },
    {
      "path": "modules/shell/aliases/gcloud/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports the gcloud module to provide Google Cloud SDK aliases in the shell environment.",
      "complexity": "low",
      "dependencies": [
        "./gcloud.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1474928,
      "error": null
    },
    {
      "path": "modules/shell/aliases/gcloud/gcloud.nix",
      "name": "gcloud",
      "category": "shell",
      "purpose": "Defines shell aliases for Google Cloud Platform (GCP) commands to simplify interaction with GCP services.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [
        "The use of 'gc' as a prefix might conflict with existing Git commands, which could lead to unintended behavior."
      ],
      "recommendations": [
        "Consider renaming aliases that might conflict with other tools or commands for clarity and avoid potential issues."
      ],
      "lines_of_code": 42,
      "has_documentation": true,
      "analysis_time_ms": 1479509,
      "error": null
    },
    {
      "path": "modules/shell/aliases/amazon/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports the AWS-related aliases module",
      "complexity": "low",
      "dependencies": [
        "./aws.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1481699,
      "error": null
    },
    {
      "path": "modules/shell/aliases/amazon/aws.nix",
      "name": "aws",
      "category": "shell",
      "purpose": "Provides a set of shell aliases for common AWS (Amazon Web Services) commands.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The use of `aws configure --profile` without specifying the profile directly could expose sensitive information if not properly secured."
      ],
      "recommendations": [
        "Consider adding a warning or note in the documentation about the security implications of using `aws configure --profile` without specifying the profile."
      ],
      "lines_of_code": 65,
      "has_documentation": true,
      "analysis_time_ms": 1486794,
      "error": null
    },
    {
      "path": "modules/shell/aliases/ai/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports another Nix module named 'ollama.nix' for shell aliases related to AI.",
      "complexity": "low",
      "dependencies": [
        "./ollama.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 4,
      "has_documentation": false,
      "analysis_time_ms": 1489497,
      "error": null
    },
    {
      "path": "modules/shell/aliases/ai/ollama.nix",
      "name": "ollama",
      "category": "shell",
      "purpose": "Defines shell aliases for managing AI/ML stack components using Docker and systemd services.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 40,
      "has_documentation": true,
      "analysis_time_ms": 1492668,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nix/rebuild-advanced.nix",
      "name": "rebuild-advanced",
      "category": "shell",
      "purpose": "Provides an advanced rebuild system for NixOS with detailed metrics and progress tracking.",
      "complexity": "medium",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [
        "The script uses ANSI escape codes which could potentially be misused in a malicious context if the output is redirected or captured improperly."
      ],
      "recommendations": [
        "Consider adding options to customize log and metrics directories.",
        "Ensure that the script does not expose sensitive information by default."
      ],
      "lines_of_code": 674,
      "has_documentation": true,
      "analysis_time_ms": 1499927,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nix/rebuild-helpers.nix",
      "name": "rebuild-helpers",
      "category": "shell",
      "purpose": "Provides colorized and enhanced rebuild commands for NixOS with performance modes and aliases.",
      "complexity": "low",
      "dependencies": [
        "pkgs",
        "lib"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 377,
      "has_documentation": true,
      "analysis_time_ms": 1505301,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nix/default.nix",
      "name": "default",
      "category": "shell",
      "purpose": "Imports other NixOS modules related to the shell environment.",
      "complexity": "low",
      "dependencies": [
        "./system.nix",
        "./rebuild-advanced.nix",
        "./analytics.nix"
      ],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [],
      "lines_of_code": 8,
      "has_documentation": false,
      "analysis_time_ms": 1508404,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nix/system.nix",
      "name": "system",
      "category": "shell",
      "purpose": "Defines shell aliases for NixOS and Nix commands to simplify system management tasks.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [
        "environment.shellAliases"
      ],
      "security_concerns": [
        "The use of `sudo` in many aliases could pose security risks if not properly managed."
      ],
      "recommendations": [
        "Consider using non-root users for Nix operations to reduce the risk of accidental system-wide changes."
      ],
      "lines_of_code": 75,
      "has_documentation": true,
      "analysis_time_ms": 1513486,
      "error": null
    },
    {
      "path": "modules/shell/aliases/nix/analytics.nix",
      "name": "analytics",
      "category": "shell",
      "purpose": "Provides scripts for analyzing NixOS build history and performance, viewing logs, and monitoring builds in real-time.",
      "complexity": "low",
      "dependencies": [],
      "imports": [],
      "options_defined": [],
      "security_concerns": [],
      "recommendations": [
        "Consider adding error handling for file operations to avoid potential crashes.",
        "Add options to customize log directories or metrics collection intervals."
      ],
      "lines_of_code": 371,
      "has_documentation": true,
      "analysis_time_ms": 1520298,
      "error": null
    }
  ],
  "dependency_graph": {
    "TEMPLATE": [],
    "default": [
      "./analytics.nix",
      "./system.nix",
      "./rebuild-advanced.nix"
    ],
    "claude-profiles": [
      "pkgs.writeShellScriptBin"
    ],
    "cicd": [
      "pkgs",
      "lib"
    ],
    "jupyter": [
      "pkgs",
      "lib"
    ],
    "environments": [],
    "dev": [],
    "secops": [],
    "llm": [
      "pkgs.jq",
      "pkgs.curl"
    ],
    "secrets": [
      "pkgs",
      "lib"
    ],
    "diagnostics": [
      "pkgs",
      "lib"
    ],
    "mcp": [],
    "intel": [
      "pkgs",
      "lib"
    ],
    "nix-utils": [
      "pkgs",
      "lib"
    ],
    "gpu-flags": [],
    "training-logger": [
      "pkgs",
      "lib"
    ],
    "bluetooth": [
      "hardware.bluetooth",
      "environment.systemPackages",
      "services.blueman",
      "kernelcore.bluetooth"
    ],
    "nvidia": [
      "virtualisation.vmVariant",
      "systemd.services",
      "hardware.nvidia",
      "users.groups"
    ],
    "lenovo-throttled": [
      "pkgs.powertop",
      "pkgs.linuxPackages.turbostat",
      "pkgs.stress-ng"
    ],
    "thermal-profiles": [
      "throttled",
      "kernelcore.hardware"
    ],
    "trezor": [
      "pkgs.trezor-suite",
      "pkgs.pinentry",
      "pkgs.trezor-udev-rules",
      "pkgs.trezor_agent",
      "pkgs.libagent"
    ],
    "wifi-optimization": [
      "pkgs",
      "lib"
    ],
    "dns-resolver": [
      "systemd-resolved",
      "dnscrypt-proxy2",
      "bind",
      "dnsutils"
    ],
    "bridge": [
      "networkmanager",
      "util-linux",
      "coreutils",
      "gawk"
    ],
    "nixos-containers": [
      "poetry",
      "nixos-container",
      "cmake",
      "ninja",
      "wireshark",
      "tcpdump",
      "nginx",
      "iptables",
      "iproute2"
    ],
    "podman": [
      "kernelcore.containers.podman",
      "virtualisation.podman",
      "hardware.nvidia-container-toolkit"
    ],
    "docker": [],
    "tools-integration": [
      "swissknife-tools"
    ],
    "debug-init": [
      "pkgs",
      "lib"
    ],
    "test-init": [],
    "vscode-secure": [
      "pkgs.vscode",
      "pkgs.firejail"
    ],
    "chromium": [
      "pkgs",
      "lib",
      "config"
    ],
    "brave-secure": [
      "pkgs.firejail",
      "pkgs.brave"
    ],
    "zellij": [
      "pkgs",
      "../../_sources/generated.nix"
    ],
    "vscodium-secure": [
      "pkgs.firejail",
      "pkgs.systemd",
      "pkgs.vscodium"
    ],
    "nemo-full": [
      "sushi",
      "p7zip",
      "exiftool",
      "imagemagick",
      "ffmpegthumbnailer",
      "libgsf",
      "mediainfo",
      "unrar",
      "file-roller",
      "poppler",
      "zip",
      "pkgs.nemo",
      "unzip"
    ],
    "firefox-privacy": [
      "pkgs",
      "lib"
    ],
    "config-auditor": [
      "pkgs",
      "lib"
    ],
    "mosh": [
      "pkgs.mosh",
      "pkgs.linux.version"
    ],
    "gpu-orchestration": [
      "pkgs.linuxPackages.nvidia_x11",
      "pkgs.docker"
    ],
    "mobile-workspace": [
      "pkgs",
      "lib"
    ],
    "offload-server": [
      "pkgs",
      "lib"
    ],
    "mcp-server": [
      "pkgs.securellm-mcp",
      "pkgs.sqlite",
      "pkgs.jq"
    ],
    "scripts": [
      "pkgs",
      "lib"
    ],
    "laptop-offload-client": [
      "pkgs.lib.mkDefault",
      "nfs-utils"
    ],
    "laptop-builder-client": [
      "pkgs",
      "lib"
    ],
    "io-scheduler": [
      "pkgs",
      "lib"
    ],
    "binary-cache": [
      "pkgs",
      "lib"
    ],
    "ml-gpu-users": [],
    "services": [
      "config.kernelcore.ml.models-storage",
      "pkgs.docker"
    ],
    "ssh-config": [
      "pkgs",
      "lib"
    ],
    "aliases": [],
    "memory": [
      "pkgs",
      "lib"
    ],
    "nix": [
      "pkgs",
      "lib"
    ],
    "emergency-monitor": [
      "pkgs",
      "lib"
    ],
    "i3-lightweight": [
      "pkgs",
      "lib"
    ],
    "hyprland": [],
    "keyring": [
      "seahorse",
      "keepassxc",
      "libgnome-keyring",
      "libsecret",
      "gnome-keyring"
    ],
    "network": [],
    "ssh": [
      "pkgs.google-authenticator"
    ],
    "dev-directory-hardening": [
      "pkgs.aide",
      "pkgs.gnupg",
      "pkgs.gnutar",
      "pkgs.ecryptfs-helper",
      "pkgs.ecryptfs",
      "pkgs.git-crypt"
    ],
    "kernel": [],
    "packages": [],
    "audit": [
      "lib",
      "pkgs",
      "pkg",
      "package",
      "name"
    ],
    "auto-upgrade": [
      "pkgs",
      "lib"
    ],
    "nix-daemon": [
      "pkgs",
      "lib"
    ],
    "aide": [
      "pkgs.mailutils",
      "pkgs.aide",
      "pkgs.coreutils",
      "pkgs.bash"
    ],
    "clamav": [
      "pkgs.clamav",
      "pkgs.sudo",
      "pkgs.bash"
    ],
    "boot": [],
    "compiler-hardening": [
      "pkgs",
      "lib"
    ],
    "hardening-template": [
      "lib",
      "nixpkgs"
    ],
    "hardening": [
      "./audit.nix",
      "./clamav.nix",
      "./nix-daemon.nix",
      "./ssh.nix",
      "./auto-upgrade.nix",
      "./kernel.nix",
      "./pam.nix",
      "./aide.nix",
      "./packages.nix"
    ],
    "pam": [
      "pkgs",
      "lib"
    ],
    "macos-kvm": [
      "kernelcore.macos-kvm.enable"
    ],
    "vmctl": [
      "pkgs.qemu_kvm",
      "pkgs.hello",
      "pkgs.qemu"
    ],
    "vms": [
      "pkgs.qemu_kvm",
      "pkgs.virtiofsd"
    ],
    "generated": [
      "fetchurl",
      "fetchFromGitHub",
      "fetchgit",
      "dockerTools"
    ],
    "appflowy": [],
    "tools": [
      "pkgs",
      "lib"
    ],
    "options": [
      "pkgs",
      "lib",
      "kernelcore"
    ],
    "phantom": [
      "pkgs.gobject-introspection",
      "pkgs.wrapGAppsHook4",
      "pkgs.gtk4",
      "pkgs.python3Packages.buildPythonApplication",
      "pkgs.libadwaita"
    ],
    "cognitive-vault": [
      "pkgs.hello"
    ],
    "video-production": [
      "pkgs",
      "lib",
      "config.modules.audio.videoProduction"
    ],
    "production": [
      "pkgs",
      "lib"
    ],
    "aws-bedrock": [
      "sops",
      "awscli2"
    ],
    "tailscale": [
      "pkgs.tailscale",
      "pkgs.jq",
      "pkgs.curl"
    ],
    "api-keys": [
      "pkgs.sops",
      "config.users.users.kernelcore.name"
    ],
    "sops-config": [
      "age",
      "sops",
      "ssh-to-age"
    ],
    "edr": [
      "pkgs.jq",
      "pkgs.iproute2",
      "pkgs.procps",
      "pkgs.gawk",
      "pkgs.gnugrep",
      "pkgs.coreutils"
    ],
    "fim": [
      "pkgs.findutils",
      "pkgs.jq",
      "pkgs.openssl",
      "pkgs.coreutils",
      "pkgs.inotify-tools"
    ],
    "dns-monitor": [
      "pkgs",
      "lib"
    ],
    "netflow": [
      "pkgs.softflowd",
      "pkgs.nfdump"
    ],
    "suricata": [
      "pkgs.ethtool",
      "pkgs.suricata"
    ],
    "threat-intel": [
      "pkgs",
      "lib"
    ],
    "wazuh": [
      "pkgs",
      "lib",
      "config"
    ],
    "log-aggregator": [
      "pkgs.vector",
      "pkgs.jq"
    ],
    "opensearch": [
      "pkgs",
      "lib"
    ],
    "alerting": [
      "pkgs.jq",
      "pkgs.curl",
      "pkgs.coreutils"
    ],
    "grafana": [
      "services.grafana",
      "networking.firewall"
    ],
    "builder": [
      "builders",
      "../lib/builders.nix",
      "fetchers",
      "../lib/fetchers.nix"
    ],
    "sandbox": [],
    "fetchers": [
      "pkgs",
      "lib"
    ],
    "types": [],
    "builders": [
      "pkgs",
      "lib",
      "sandbox",
      "./sandbox.nix"
    ],
    "build-gemini": [
      "nixpkgs"
    ],
    "js-packages": [
      "types",
      "builder",
      "./builder.nix",
      "../lib/types.nix"
    ],
    "gemini-cli": [
      "pkgs.callPackage",
      "buildNpmPackage",
      "mkEnableOption"
    ],
    "codex": [],
    "lynis": [
      "pkgs",
      "_sources/generated.nix"
    ],
    "protonpass": [],
    "antigravity": [],
    "protonvpn": [],
    "all": [
      "./packages/protonpass.nix",
      "./packages/cursor.nix",
      "./packages/protonvpn.nix"
    ],
    "example": [],
    "cursor": [],
    "llama-cpp-swap": [
      "lib.mkOption",
      "lib.mkPackageOption",
      "lib.mkEnableOption",
      "pkgs.formats.yaml"
    ],
    "llama-cpp": [
      "pkgs.llama-cpp",
      "pkgs.cudaPackages"
    ],
    "storage": [
      "config.kernelcore.ml.models-storage",
      "pkgs",
      "lib"
    ],
    "manager": [
      "pkgs.cudatoolkit",
      "pkgs.rustPlatform.buildRustPackage",
      "pkgs.sqlite",
      "pkgs.linuxPackages.nvidia_x11",
      "pkgs.openssl"
    ],
    "flake": [
      "nixpkgs"
    ],
    "database": [
      "pkgs.python311",
      "pkgs.writeShellScript"
    ],
    "monitoring": [
      "nvidia-smi",
      "python311Packages.nvidia-ml-py",
      "requests"
    ],
    "gpu-manager": [
      "pkgs.jq",
      "pkgs.curl"
    ],
    "config": [
      "securellm-mcp",
      "pkgs.jq"
    ],
    "yazi": [],
    "gemini-agent": [
      "kernelcore.packages.gemini-cli"
    ],
    "actions": [
      "pkgs",
      "lib",
      "config"
    ],
    "claude-code": [
      "pkgs",
      "lib"
    ],
    "gitlab-runner": [
      "pkgs",
      "lib",
      "config"
    ],
    "codex-agent": [
      "pkgs.codex",
      "pkgs.nodejs_22"
    ],
    "tailscale-monitor": [
      "pkgs.tailscale",
      "pkgs.mailutils",
      "pkgs.bc",
      "pkgs.netcat"
    ],
    "firewall-zones": [
      "pkgs",
      "lib"
    ],
    "tailscale-services": [
      "kernelcore.network.vpn.tailscale",
      "kernelcore.secrets.tailscale",
      "kernelcore.network.proxy.nginx-tailscale"
    ],
    "nginx-tailscale": [
      "pkgs.nginxQuic",
      "pkgs.nginx"
    ],
    "tailscale-desktop": [
      "./tailscale.nix"
    ],
    "tailscale-laptop": [
      "pkgs.tailscale",
      "./tailscale.nix"
    ],
    "nordvpn": [
      "pkgs.wireguard-tools",
      "pkgs.openresolv",
      "pkgs.curl",
      "pkgs.jq"
    ],
    "mcp-integration": [
      "pkgs.lm_sensors",
      "pkgs.writeShellScriptBin",
      "pkgs.bash"
    ],
    "rebuild-hooks": [
      "pkgs.lm_sensors",
      "pkgs.bash"
    ],
    "service-control": [
      "pkgs"
    ],
    "laptop-defense": [
      "thermal-profile",
      "nixpkgs"
    ],
    "sync": [],
    "nixos-explorer": [
      "pkgs",
      "lib"
    ],
    "emergency": [],
    "kubectl": [],
    "navigation": [
      "tree",
      "eza"
    ],
    "utils": [],
    "compose": [],
    "run": [
      "pkgs",
      "lib",
      "config"
    ],
    "build": [
      "pkgs",
      "lib",
      "config"
    ],
    "gcloud": [],
    "aws": [],
    "ollama": [
      "pkgs",
      "lib"
    ],
    "rebuild-advanced": [
      "pkgs",
      "lib"
    ],
    "rebuild-helpers": [
      "pkgs",
      "lib"
    ],
    "system": [],
    "analytics": []
  }
}